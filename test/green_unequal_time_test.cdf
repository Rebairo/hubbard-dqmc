(* Content-type: application/vnd.wolfram.cdf.text *)

(*** Wolfram CDF File ***)
(* http://www.wolfram.com/cdf *)

(* CreatedBy='Mathematica 10.0' *)

(*************************************************************************)
(*                                                                       *)
(*  The Mathematica License under which this file was created prohibits  *)
(*  restricting third parties in receipt of this file from republishing  *)
(*  or redistributing it by any means, including but not limited to      *)
(*  rights management or terms of use, without the express consent of    *)
(*  Wolfram Research, Inc. For additional information concerning CDF     *)
(*  licensing and redistribution see:                                    *)
(*                                                                       *)
(*        www.wolfram.com/cdf/adopting-cdf/licensing-options.html        *)
(*                                                                       *)
(*************************************************************************)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[      1064,         20]
NotebookDataLength[     43085,       1105]
NotebookOptionsPosition[     41963,       1044]
NotebookOutlinePosition[     42307,       1059]
CellTagsIndexPosition[     42264,       1056]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "Reference:\n\tR. Blankenbecler, D. J. Scalapino, R. L. Sugar\n\tMonte Carlo \
calculations of coupled boson-fermion systems. I\n\tPhys. Rev. D 24, 2278 \
(1981) ",
 Cell[BoxData[
  FormBox[
   ButtonBox["DOI",
    BaseStyle->"Hyperlink",
    ButtonData->{
      URL["http://dx.doi.org/10.1103/PhysRevD.24.2278"], None},
    ButtonNote->"http://dx.doi.org/10.1103/PhysRevD.24.2278"], 
   TraditionalForm]]]
}], "Text"],

Cell[CellGroupData[{

Cell["Random B matrices", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"block", " ", "size"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    SubscriptBox["n", "val"], "=", "5"}], ";"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"number", " ", "of", " ", "time", " ", "steps"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    SubscriptBox["L", "val"], "=", "6"}], ";"}]}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SeedRandom", "[", "42", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     SubscriptBox["B", "i"], "=", 
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
       RowBox[{
        SubscriptBox["n", "val"], 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}]}], ",", 
       RowBox[{"WorkingPrecision", "\[Rule]", 
        RowBox[{"2", "MachinePrecision"}]}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      SubscriptBox["L", "val"]}], "}"}]}], "]"}], ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "example", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   SubscriptBox["B", "2"], "//", "MatrixForm"}]}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.4701525469139628219065106903090759682669696173526096406719`31.\
909179540382006", 
      "0.2400277101007709609625699323384271286132487890617430971973`31.\
909179540382006", 
      "0.9780450824885695825181112102879153516802217188427728512453`31.\
909179540382006", 
      "0.0954956615833911023522757287769700226325615442677395657806`31.\
909179540382006", 
      RowBox[{
      "-", "0.5030931329013885931729054825463520161931724256141502146361`31.\
909179540382006"}]},
     {"0.309395027057995638327872323664835265615158576470973504565`31.\
909179540382006", 
      "0.9671894507789101022533517264464769768119203967216328329837`31.\
909179540382006", 
      "0.6098839943358871857726699973376679352930084058301908131189`31.\
909179540382006", 
      RowBox[{
      "-", "0.8158748554153668595399117341092147460119892082259535614827`31.\
909179540382006"}], 
      "0.6234189541137121184505227255206447500510517703641820934075`31.\
909179540382006"},
     {"0.8921899858622822639709473692332970746861280726343358859515`31.\
909179540382006", 
      RowBox[{
      "-", "0.8020320552426841667785952998915136898696000364887285035354`31.\
909179540382006"}], 
      "0.3394722655565544032037734677392400538766276868277947190183`31.\
909179540382006", 
      RowBox[{
      "-", "0.5197864144383457326073902380742009002150087741785634241745`31.\
909179540382006"}], 
      "0.9698553608919895718612549337681935672908128543784921984114`31.\
909179540382006"},
     {
      RowBox[{
      "-", "0.9710982609457023088663440964314586636934221891780825448148`31.\
909179540382006"}], 
      "0.6443423420123493111246383533866200033772334660975786611291`31.\
909179540382006", 
      RowBox[{
      "-", "0.6585616448737773794672615528564197605955609364898819756948`31.\
909179540382006"}], 
      "0.8952638519896262542526840305543323810810064802425164652866`31.\
909179540382006", 
      RowBox[{
      "-", "0.5517645415911625574551826380200463933648767285575877454512`31.\
909179540382006"}]},
     {"0.3131854236727004256936920540150418903172773261100870054189`31.\
909179540382006", 
      RowBox[{
      "-", "0.4439637951821276937788534844679275752840940444946285316205`31.\
909179540382006"}], 
      "0.2674727376935182461972487292732353257948546466032845690093`31.\
909179540382006", 
      "0.518473878365793755666898099383364108513357457998456566118`31.\
909179540382006", 
      "0.2108326811540198831125728486213025659441526346284179866955`31.\
909179540382006"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["fn", "base"], "=", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
    RowBox[{"FileBaseName", "[", 
     RowBox[{"NotebookFileName", "[", "]"}], "]"}]}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"save", " ", "to", " ", "disk"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{
         SubscriptBox["fn", "base"], "<>", "\"\<_B\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"i", "-", "1"}], "]"}], "<>", "\"\<.dat\>\""}], ",", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Transpose", "[", 
          SubscriptBox["B", "i"], "]"}], "]"}], ",", "\"\<Real64\>\""}], 
       "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        SubscriptBox["L", "val"]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{
         SubscriptBox["fn", "base"], "<>", "\"\<_invB\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"i", "-", "1"}], "]"}], "<>", "\"\<.dat\>\""}], ",", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Transpose", "[", 
          RowBox[{"Inverse", "[", 
           SubscriptBox["B", "i"], "]"}], "]"}], "]"}], ",", 
        "\"\<Real64\>\""}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        SubscriptBox["L", "val"]}], "}"}]}], "]"}], ";"}]}]}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Construct H matrix", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"cyclically", " ", "shifted", " ", "Eq", " ", 
    RowBox[{"(", "45", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Op", "[", "blist_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"L", "=", 
       RowBox[{"Length", "[", "blist", "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "L", "]"}], "+", 
      RowBox[{"RotateRight", "[", 
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "\[Equal]", "L"}], ",", "1", ",", 
             RowBox[{"-", "1"}]}], "]"}], 
           RowBox[{
           "blist", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "L"}], "}"}]}], "]"}], "]"}], "]"}]}]}], 
    "]"}]}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "example", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Op", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      SubscriptBox["b", "i"], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "5"}], "}"}]}], "]"}], "]"}], "//", 
   "MatrixForm"}]}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", 
      SubscriptBox["b", "5"]},
     {
      RowBox[{"-", 
       SubscriptBox["b", "1"]}], "1", "0", "0", "0"},
     {"0", 
      RowBox[{"-", 
       SubscriptBox["b", "2"]}], "1", "0", "0"},
     {"0", "0", 
      RowBox[{"-", 
       SubscriptBox["b", "3"]}], "1", "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       SubscriptBox["b", "4"]}], "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["H", "val"], "=", 
   RowBox[{"ArrayFlatten", "[", 
    RowBox[{
     RowBox[{"Op", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        SubscriptBox["b", "i"], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          SubscriptBox["L", "val"]}], "}"}]}], "]"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0", "\[Rule]", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{
           SubscriptBox["n", "val"], 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}]}], ",", 
       RowBox[{"1", "\[Rule]", 
        RowBox[{"IdentityMatrix", "[", 
         SubscriptBox["n", "val"], "]"}]}], ",", 
       RowBox[{
        SubscriptBox["b", "i_"], "\[RuleDelayed]", 
        SubscriptBox["B", "i"]}]}], "}"}]}], "]"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"N", "[", 
   SubscriptBox["H", "val"], "]"}], "//", "MatrixForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.5750830933591384`", 
      "0.9369328846710157`", "0.8978277910278182`", 
      RowBox[{"-", "0.8472035795015712`"}], "0.9362414161486323`"},
     {"0.`", "1.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.33736607702214355`"}], 
      RowBox[{"-", "0.4306596218256428`"}], "0.2757769547132563`", 
      "0.921584716320252`", "0.7533492300540907`"},
     {"0.`", "0.`", "1.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.5708915328756228`", 
      RowBox[{"-", "0.8580462300985079`"}], "0.48482275023240884`", 
      "0.9101693337081602`", 
      RowBox[{"-", "0.7875917503707573`"}]},
     {"0.`", "0.`", "0.`", "1.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.7337152103453435`", 
      "0.23718504985308125`", "0.5610306344524095`", "0.9311399965976861`", 
      "0.9271681065855653`"},
     {"0.`", "0.`", "0.`", "0.`", "1.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.7187405386341799`", 
      RowBox[{"-", "0.8034460016606206`"}], 
      RowBox[{"-", "0.37107141786907955`"}], "0.8663337434953298`", 
      "0.7640088784209685`"},
     {"0.14818943256807487`", "0.22344517192272403`", 
      RowBox[{"-", "0.7908269452198432`"}], 
      RowBox[{"-", "0.9965520185656148`"}], "0.513110639083837`", "1.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`"},
     {"0.9857479592521711`", "0.9877734855785923`", 
      RowBox[{"-", "0.9094578695948946`"}], 
      RowBox[{"-", "0.8428757457306598`"}], "0.044064720359607755`", "0.`", 
      "1.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`"},
     {
      RowBox[{"-", "0.8606215140816531`"}], "0.9350647072481315`", 
      RowBox[{"-", "0.9950327539971698`"}], "0.9170822821730071`", 
      RowBox[{"-", "0.09146856076958794`"}], "0.`", "0.`", "1.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`"},
     {"0.44125448507560616`", 
      RowBox[{"-", "0.3023452009777999`"}], 
      RowBox[{"-", "0.46159247475054227`"}], "0.8649963526990475`", 
      "0.8370678837961374`", "0.`", "0.`", "0.`", "1.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.5225551652464618`", "0.7223353953785538`", "0.2699662724355662`", 
      RowBox[{"-", "0.5570803964160375`"}], 
      RowBox[{"-", "0.23494615192458695`"}], "0.`", "0.`", "0.`", "0.`", 
      "1.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.4701525469139628`"}], 
      RowBox[{"-", "0.24002771010077095`"}], 
      RowBox[{"-", "0.9780450824885696`"}], 
      RowBox[{"-", "0.09549566158339111`"}], "0.5030931329013886`", "1.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.30939502705799565`"}], 
      RowBox[{"-", "0.96718945077891`"}], 
      RowBox[{"-", "0.6098839943358871`"}], "0.8158748554153669`", 
      RowBox[{"-", "0.6234189541137121`"}], "0.`", "1.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.8921899858622823`"}], "0.8020320552426842`", 
      RowBox[{"-", "0.3394722655565544`"}], "0.5197864144383457`", 
      RowBox[{"-", "0.9698553608919895`"}], "0.`", "0.`", "1.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.9710982609457023`", 
      RowBox[{"-", "0.6443423420123493`"}], "0.6585616448737773`", 
      RowBox[{"-", "0.8952638519896262`"}], "0.5517645415911625`", "0.`", 
      "0.`", "0.`", "1.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.3131854236727004`"}], "0.4439637951821277`", 
      RowBox[{"-", "0.26747273769351826`"}], 
      RowBox[{"-", "0.5184738783657937`"}], 
      RowBox[{"-", "0.21083268115401987`"}], "0.`", "0.`", "0.`", "0.`", 
      "1.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.16992404407755252`", 
      RowBox[{"-", "0.7951926249697979`"}], "0.15138147082106881`", 
      "0.848770628169602`", "0.5957037473734683`", "1.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.9487599719092318`", 
      RowBox[{"-", "0.2716997086645923`"}], "0.21851237380405295`", 
      RowBox[{"-", "0.7014806580427522`"}], 
      RowBox[{"-", "0.8465592522642582`"}], "0.`", "1.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.005831282137754713`", 
      RowBox[{"-", "0.6713008486973747`"}], 
      RowBox[{"-", "0.44555165234067473`"}], "0.4516839236888155`", 
      RowBox[{"-", "0.6352768473669813`"}], "0.`", "0.`", "1.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.19982712403073793`"}], "0.13000456980034894`", 
      "0.8832421789913679`", 
      RowBox[{"-", "0.9291069516953159`"}], 
      RowBox[{"-", "0.28024016117099765`"}], "0.`", "0.`", "0.`", "1.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.753646487537347`"}], "0.8157398347033145`", 
      RowBox[{"-", "0.8946309731687639`"}], "0.013262726986897854`", 
      "0.7682423165826436`", "0.`", "0.`", "0.`", "0.`", "1.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.7547569016548558`", 
      "0.5686391233416268`", 
      RowBox[{"-", "0.9312739681001516`"}], 
      RowBox[{"-", "0.17368769337781817`"}], "0.6014329585002102`", "1.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.22039418349422105`"}], "0.5427940664200066`", 
      "0.13276827094080584`", "0.9660637243152974`", 
      RowBox[{"-", "0.6372338915130267`"}], "0.`", "1.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.29219200116600674`"}], "0.4675091568355077`", 
      RowBox[{"-", "0.1121099671081528`"}], "0.31718502666936416`", 
      "0.27658451880847906`", "0.`", "0.`", "1.`", "0.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.4442538088053955`", 
      "0.5721942324833684`", "0.7504317565604062`", "0.4693507828588377`", 
      RowBox[{"-", "0.8872773194983838`"}], "0.`", "0.`", "0.`", "1.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.5200295228687075`"}], "0.604347647633128`", 
      RowBox[{"-", "0.6747436066471942`"}], 
      RowBox[{"-", "0.07039779852939565`"}], 
      RowBox[{"-", "0.8050298761737186`"}], "0.`", "0.`", "0.`", "0.`", "1.`",
       "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.23622627398352114`", 
      RowBox[{"-", "0.12176156328413652`"}], 
      RowBox[{"-", "0.34348208582619`"}], 
      RowBox[{"-", "0.7103203721018805`"}], 
      RowBox[{"-", "0.1772633949337909`"}], "1.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.6493580925464275`", 
      RowBox[{"-", "0.3879030771478586`"}], 
      RowBox[{"-", "0.38373064951666586`"}], "0.03534781802952623`", 
      RowBox[{"-", "0.8009481206343173`"}], "0.`", "1.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.3679939207685129`"}], 
      RowBox[{"-", "0.14555034380863605`"}], 
      RowBox[{"-", "0.5719263300489104`"}], "0.7695583198760179`", 
      RowBox[{"-", "0.38874319762565335`"}], "0.`", "0.`", "1.`", "0.`", 
      "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.3706461314356914`"}], 
      RowBox[{"-", "0.6306237257121398`"}], "0.6510362477771195`", 
      RowBox[{"-", "0.8860495846306607`"}], 
      RowBox[{"-", "0.9655460885435924`"}], "0.`", "0.`", "0.`", "1.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.15165623153350302`", 
      RowBox[{"-", "0.6110106334654467`"}], 
      RowBox[{"-", "0.6966604195279351`"}], 
      RowBox[{"-", "0.32042460330903366`"}], 
      RowBox[{"-", "0.2577028010043679`"}], "0.`", "0.`", "0.`", "0.`", "1.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute inverse H matrix", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["invH", "val"], "=", 
   RowBox[{"Inverse", "[", 
    SubscriptBox["H", "val"], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "%", "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"30", ",", "30"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"no", " ", "obvious", " ", "block", " ", "structure"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"N", "[", 
     SubscriptBox["invH", "val"], "]"}], "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "\[RightDoubleBracket]"}], "//", 
   "MatrixForm"}]}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "0.13607202141741653`"}], 
      RowBox[{"-", "0.6251296063863258`"}], "0.12439815934690628`", 
      "0.26402441171560737`"},
     {
      RowBox[{"-", "0.052247211669026745`"}], "3.1113995153728875`", 
      RowBox[{"-", "1.0380717316684558`"}], 
      RowBox[{"-", "1.68922624248357`"}]},
     {"0.3034788924205859`", "2.007919163359018`", 
      RowBox[{"-", "0.151230965868712`"}], 
      RowBox[{"-", "0.8294936598478423`"}]},
     {"0.13490253184522008`", 
      RowBox[{"-", "0.1720130715885079`"}], 
      RowBox[{"-", "0.06050493283264308`"}], "0.5901811376565078`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Extract unequal time Green\[CloseCurlyQuote]s functions", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"G", 
    RowBox[{"(", 
     RowBox[{"\[Tau]", ",", "0"}], ")"}], " ", "is", " ", "the", " ", "first",
     " ", "block", " ", "column"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["G", 
      RowBox[{"\[Tau]", ",", "0"}]], "=", 
     RowBox[{
      SubscriptBox["invH", "val"], "\[LeftDoubleBracket]", 
      RowBox[{";;", ",", 
       RowBox[{"1", ";;", 
        SubscriptBox["n", "val"]}]}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Dimensions", "[", "%", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"30", ",", "5"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"N", "[", 
   SubscriptBox["G", 
    RowBox[{"\[Tau]", ",", "0"}]], "]"}], "//", "MatrixForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "0.13607202141741653`"}], 
      RowBox[{"-", "0.6251296063863258`"}], "0.12439815934690628`", 
      "0.39611300179011083`", "0.08510945619278167`"},
     {
      RowBox[{"-", "0.052247211669026745`"}], "3.1113995153728875`", 
      RowBox[{"-", "1.0380717316684558`"}], 
      RowBox[{"-", "1.2862970292930656`"}], 
      RowBox[{"-", "0.30207938793369155`"}]},
     {"0.3034788924205859`", "2.007919163359018`", 
      RowBox[{"-", "0.151230965868712`"}], 
      RowBox[{"-", "1.0167482533712808`"}], 
      RowBox[{"-", "0.18810241100075117`"}]},
     {
      RowBox[{"-", "0.313133395253883`"}], "2.1680760107645414`", 
      RowBox[{"-", "0.967036710899375`"}], 
      RowBox[{"-", "0.570933352640472`"}], 
      RowBox[{"-", "0.5395708772109511`"}]},
     {"0.7125104993104368`", "1.289469526874036`", 
      RowBox[{"-", "0.1996393301173586`"}], 
      RowBox[{"-", "1.2105733343011893`"}], "0.49600773962488076`"},
     {
      RowBox[{"-", "0.4058123265079038`"}], "2.4842869721443335`", 
      RowBox[{"-", "0.767345220866991`"}], 
      RowBox[{"-", "0.5231615432044178`"}], 
      RowBox[{"-", "0.8860878914416871`"}]},
     {"0.1664132748302684`", "1.139578744323246`", 
      RowBox[{"-", "0.04107842866975485`"}], 
      RowBox[{"-", "0.4724694833775922`"}], 
      RowBox[{"-", "0.43322932863529096`"}]},
     {"0.5860608513418474`", 
      RowBox[{"-", "3.3197727044958634`"}], "1.7958357192410723`", 
      "0.9448399732178969`", "0.7087427489843998`"},
     {
      RowBox[{"-", "0.14123114201932924`"}], 
      RowBox[{"-", "0.8113530396825979`"}], "0.5650405715559605`", 
      "0.47417161184443013`", 
      RowBox[{"-", "0.16417914806806`"}]},
     {"0.019877206645632122`", 
      RowBox[{"-", "0.9521311993359441`"}], "0.14003662750400178`", 
      "0.3941593891573072`", "0.040460306486407235`"},
     {"0.39885698459707336`", 
      RowBox[{"-", "1.4038330722088108`"}], "1.369286480590303`", 
      "0.41170703919528145`", "0.13656513903051354`"},
     {"0.520444746038172`", 
      RowBox[{"-", "0.08547575502463634`"}], "0.4444071366189996`", 
      RowBox[{"-", "0.18372656419195654`"}], 
      RowBox[{"-", "0.10174180422012047`"}]},
     {
      RowBox[{"-", "0.20389102538050827`"}], 
      RowBox[{"-", "0.32619274560138034`"}], 
      RowBox[{"-", "0.1999202238017914`"}], "0.36873278192527287`", 
      RowBox[{"-", "0.07791769195779896`"}]},
     {
      RowBox[{"-", "0.022053108505637242`"}], "0.3070442386716764`", 
      RowBox[{"-", "0.03537633355191859`"}], 
      RowBox[{"-", "0.2116006665025363`"}], 
      RowBox[{"-", "0.054728599357660605`"}]},
     {
      RowBox[{"-", "0.11325456728575728`"}], 
      RowBox[{"-", "1.2372436609092643`"}], "0.5807361674701894`", 
      "0.6275789851311843`", "0.027805443875205494`"},
     {"0.46312795613054664`", "0.6963753943150212`", 
      RowBox[{"-", "0.16494151957935566`"}], 
      RowBox[{"-", "0.4661269673865543`"}], 
      RowBox[{"-", "0.06242651771768285`"}]},
     {
      RowBox[{"-", "0.3038086745376593`"}], "0.5479395657186245`", 
      RowBox[{"-", "0.667882108681097`"}], 
      RowBox[{"-", "0.13825326677557961`"}], 
      RowBox[{"-", "0.15503687432025562`"}]},
     {"0.1942181989741489`", 
      RowBox[{"-", "1.1192087157534507`"}], "0.5861785688994638`", 
      "0.5328159403339611`", 
      RowBox[{"-", "0.06142788255466525`"}]},
     {"0.13989922774333463`", 
      RowBox[{"-", "0.04275292159540109`"}], "0.5223007946144029`", 
      RowBox[{"-", "0.24025163353912637`"}], "0.06627999044372647`"},
     {
      RowBox[{"-", "0.2190581365981084`"}], 
      RowBox[{"-", "0.33365932679822735`"}], "0.044905606019859746`", 
      "0.31070807711581494`", "0.09557363117942377`"},
     {"0.16012638729958067`", 
      RowBox[{"-", "1.6862158914379266`"}], "1.1138769977064142`", 
      "0.6980275470133132`", "0.03210157635654911`"},
     {
      RowBox[{"-", "0.033552598686892095`"}], 
      RowBox[{"-", "0.16666283717427188`"}], 
      RowBox[{"-", "0.22761609771038777`"}], "0.331662434334013`", 
      "0.07542239031774685`"},
     {"0.3153435664881946`", 
      RowBox[{"-", "0.0723203057236533`"}], "0.151676681990584`", 
      RowBox[{"-", "0.02156274888009304`"}], 
      RowBox[{"-", "0.00010325596568520475`"}]},
     {
      RowBox[{"-", "0.43768341965631846`"}], 
      RowBox[{"-", "0.05898775390272985`"}], 
      RowBox[{"-", "0.1897513853481686`"}], "0.2747909225856783`", 
      "0.21623360726708798`"},
     {"0.38899400896211306`", 
      RowBox[{"-", "0.9958045871000771`"}], "0.7862979438327787`", 
      "0.4338835001196756`", "0.10139006093275467`"},
     {
      RowBox[{"-", "0.17553766161291848`"}], "0.13477473501128318`", 
      RowBox[{"-", "0.23414611332276827`"}], "0.14018612457508647`", 
      "0.17313272859391637`"},
     {"0.33104764417802357`", "0.20705466544501694`", 
      RowBox[{"-", "0.11690387776381629`"}], "0.004913669213333193`", 
      "0.08193632897424348`"},
     {"0.7224369254619079`", 
      RowBox[{"-", "1.0278546600567307`"}], "0.9152109847213008`", 
      "0.2500127898741413`", 
      RowBox[{"-", "0.10425779003232852`"}]},
     {
      RowBox[{"-", "0.17932649945096693`"}], 
      RowBox[{"-", "1.696769094639083`"}], "0.7616448385332402`", 
      "1.1443264403186313`", "0.34901917190330595`"},
     {"0.13490253184522008`", 
      RowBox[{"-", "0.1720130715885079`"}], 
      RowBox[{"-", "0.06050493283264308`"}], "0.2816298987843808`", 
      "0.1365586145716449`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"G", 
    RowBox[{"(", 
     RowBox[{"0", ",", "\[Tau]"}], ")"}], " ", "is", " ", "the", " ", "first",
     " ", "block", " ", "row"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["G", 
      RowBox[{"0", ",", "\[Tau]"}]], "=", 
     RowBox[{
      SubscriptBox["invH", "val"], "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"1", ";;", 
        SubscriptBox["n", "val"]}], ",", ";;"}], "\[RightDoubleBracket]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"Dimensions", "[", "%", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5", ",", "30"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"N", "[", 
   SubscriptBox["G", 
    RowBox[{"0", ",", "\[Tau]"}]], "]"}], "//", "MatrixForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "0.13607202141741653`"}], 
      RowBox[{"-", "0.6251296063863258`"}], "0.12439815934690628`", 
      "0.39611300179011083`", "0.08510945619278167`", 
      RowBox[{"-", "0.4549065719147693`"}], "0.7641039426214808`", 
      RowBox[{"-", "0.21784330133915747`"}], "0.20557531895943984`", 
      "0.32930265393392183`", 
      RowBox[{"-", "0.6321704081140446`"}], "0.7627210982330096`", 
      RowBox[{"-", "0.5813552421892352`"}], "0.15146482308322906`", 
      "0.8687964756715121`", "0.04531283537229573`", "0.23750000362467713`", 
      "0.3234722104500237`", "0.17417495596933275`", 
      RowBox[{"-", "0.573291060282208`"}], "0.1113483412249577`", 
      "0.016655861074219753`", "0.056667047555955266`", 
      RowBox[{"-", "0.42551916891643893`"}], 
      RowBox[{"-", "0.1536706216172798`"}], 
      RowBox[{"-", "0.5554684106328726`"}], 
      RowBox[{"-", "0.06055958646534625`"}], "0.043604681696157506`", 
      RowBox[{"-", "0.0949640553866995`"}], "0.26402441171560737`"},
     {
      RowBox[{"-", "0.052247211669026745`"}], "3.1113995153728875`", 
      RowBox[{"-", "1.0380717316684558`"}], 
      RowBox[{"-", "1.2862970292930656`"}], 
      RowBox[{"-", "0.30207938793369155`"}], 
      RowBox[{"-", "0.8880439117706167`"}], 
      RowBox[{"-", "0.06803317356950142`"}], 
      RowBox[{"-", "0.8354574316018901`"}], "0.4576321487210232`", 
      RowBox[{"-", "1.2822289882073463`"}], "0.36290677189318205`", 
      RowBox[{"-", "1.0033768043756848`"}], 
      RowBox[{"-", "0.010601137818942397`"}], "0.32836055524496116`", 
      RowBox[{"-", "1.3407299204506005`"}], "0.3631950681811146`", 
      "0.12311128341276788`", 
      RowBox[{"-", "1.1197055262155977`"}], "0.05782594110162534`", 
      "0.6944116409681238`", 
      RowBox[{"-", "0.854178826003349`"}], 
      RowBox[{"-", "0.7457943494006992`"}], "0.5143714517209558`", 
      "0.7696399617674674`", "0.1432355241882058`", "2.833245896191117`", 
      "0.5605786820534401`", "0.30169651892930816`", 
      RowBox[{"-", "0.5074370296639813`"}], 
      RowBox[{"-", "1.68922624248357`"}]},
     {"0.3034788924205859`", "2.007919163359018`", 
      RowBox[{"-", "0.151230965868712`"}], 
      RowBox[{"-", "1.0167482533712808`"}], 
      RowBox[{"-", "0.18810241100075117`"}], 
      RowBox[{"-", "0.565454918449046`"}], 
      RowBox[{"-", "0.40861726473170773`"}], 
      RowBox[{"-", "0.7170631220645698`"}], "0.22745875430504714`", 
      RowBox[{"-", "1.022624968497654`"}], "0.37480629405962673`", 
      RowBox[{"-", "1.0846076213026896`"}], "0.2581862180610013`", 
      "0.197609607569801`", 
      RowBox[{"-", "1.419451948406704`"}], "0.3172238561680607`", 
      "0.1538425918483801`", 
      RowBox[{"-", "1.118847357368675`"}], 
      RowBox[{"-", "0.14628067490624616`"}], "0.7926481308338632`", 
      RowBox[{"-", "0.7937126773927079`"}], 
      RowBox[{"-", "0.37299242361302143`"}], "0.21564727285490953`", 
      "0.6471050054121732`", "0.04776180905959782`", "1.4704151956122682`", 
      "0.5406545484410912`", 
      RowBox[{"-", "0.2522619136816826`"}], 
      RowBox[{"-", "0.34601899008794296`"}], 
      RowBox[{"-", "0.8294936598478423`"}]},
     {
      RowBox[{"-", "0.313133395253883`"}], "2.1680760107645414`", 
      RowBox[{"-", "0.967036710899375`"}], 
      RowBox[{"-", "0.570933352640472`"}], 
      RowBox[{"-", "0.5395708772109511`"}], 
      RowBox[{"-", "0.9782949072633799`"}], 
      RowBox[{"-", "0.028615068866425047`"}], 
      RowBox[{"-", "0.870147740022266`"}], "0.8162234495112866`", 
      RowBox[{"-", "1.1916761265488724`"}], "0.21286591297205867`", 
      RowBox[{"-", "0.8553295315422497`"}], 
      RowBox[{"-", "0.13855684281553587`"}], "0.46686529093388995`", 
      RowBox[{"-", "0.7559373367779556`"}], 
      RowBox[{"-", "0.005825863986113324`"}], "0.05141180797051558`", 
      RowBox[{"-", "0.8805481269479524`"}], "0.034980121217281605`", 
      "0.3297683020007241`", 
      RowBox[{"-", "0.467003788983884`"}], 
      RowBox[{"-", "0.5965845525777344`"}], "0.41535898062653803`", 
      "0.6875815864242485`", 
      RowBox[{"-", "0.08214969094923975`"}], "2.2703000380901415`", 
      "0.09922635783425089`", "0.27216763309065667`", 
      RowBox[{"-", "0.3841189518607614`"}], 
      RowBox[{"-", "1.1601919395215337`"}]},
     {"0.7125104993104368`", "1.289469526874036`", 
      RowBox[{"-", "0.1996393301173586`"}], 
      RowBox[{"-", "1.2105733343011893`"}], "0.49600773962488076`", 
      RowBox[{"-", "0.006569992536081081`"}], 
      RowBox[{"-", "0.5774444518881906`"}], 
      RowBox[{"-", "0.06330887400139655`"}], "0.4235130745712811`", 
      RowBox[{"-", "0.7342463609060802`"}], "0.7003183518290732`", 
      RowBox[{"-", "0.8801365109224253`"}], "0.48818575188608715`", 
      "0.2870712994934586`", 
      RowBox[{"-", "0.7034062648000332`"}], 
      RowBox[{"-", "0.04412889260356736`"}], 
      RowBox[{"-", "0.025608170821465017`"}], 
      RowBox[{"-", "0.19854448485662854`"}], "0.20334532429054047`", 
      "0.8315995823317133`", 
      RowBox[{"-", "0.16385281088391937`"}], 
      RowBox[{"-", "0.22471000766031943`"}], 
      RowBox[{"-", "0.5602483857885998`"}], "0.4133115548562365`", 
      "0.44044071649199157`", "0.6709581355902962`", "0.4020934985767296`", 
      RowBox[{"-", "0.035304996904021835`"}], "0.2944966419058748`", 
      RowBox[{"-", "1.0522863341858328`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"G", 
    RowBox[{"(", 
     RowBox[{"\[Tau]", ",", "\[Tau]"}], ")"}], " ", "is", " ", "the", " ", 
    "block", " ", "diagonal"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"n", "=", 
         SubscriptBox["n", "val"]}], ",", 
        RowBox[{"L", "=", 
         SubscriptBox["L", "val"]}]}], "}"}], ",", 
      RowBox[{
       SubscriptBox["G", 
        RowBox[{"\[Tau]", ",", "\[Tau]"}]], "=", 
       RowBox[{"ArrayFlatten", "[", 
        RowBox[{"{", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            SubscriptBox["invH", "val"], "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"n", 
                RowBox[{"(", 
                 RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}], ";;", 
              RowBox[{"n", " ", "i"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"n", 
                RowBox[{"(", 
                 RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}], ";;", 
              RowBox[{"n", " ", "i"}]}]}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "L"}], "}"}]}], "]"}], "}"}], "]"}]}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"Dimensions", "[", "%", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5", ",", "30"}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"save", " ", "unequal", " ", "time", " ", 
   RowBox[{"Green", "'"}], "s", " ", "functions", " ", "as", " ", "reference",
    " ", "to", " ", "disk"}], " ", "*)"}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     SubscriptBox["fn", "base"], "<>", "\"\<_Gtau0\>\"", "<>", 
     "\"\<.dat\>\""}], ",", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Transpose", "[", 
      SubscriptBox["G", 
       RowBox[{"\[Tau]", ",", "0"}]], "]"}], "]"}], ",", "\"\<Real64\>\""}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     SubscriptBox["fn", "base"], "<>", "\"\<_G0tau\>\"", "<>", 
     "\"\<.dat\>\""}], ",", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Transpose", "[", 
      SubscriptBox["G", 
       RowBox[{"0", ",", "\[Tau]"}]], "]"}], "]"}], ",", "\"\<Real64\>\""}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     SubscriptBox["fn", "base"], "<>", "\"\<_Geqlt\>\"", "<>", 
     "\"\<.dat\>\""}], ",", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Transpose", "[", 
      SubscriptBox["G", 
       RowBox[{"\[Tau]", ",", "\[Tau]"}]], "]"}], "]"}], ",", 
    "\"\<Real64\>\""}], "]"}], ";"}]}], "Input"]
}, Open  ]]
},
WindowSize->{1600, 778},
WindowMargins->{{157, Automatic}, {135, Automatic}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (July 1, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[1464, 33, 435, 12, 87, "Text"],
Cell[CellGroupData[{
Cell[1924, 49, 39, 0, 43, "Subsection"],
Cell[1966, 51, 201, 6, 52, "Input"],
Cell[2170, 59, 230, 7, 52, "Input"],
Cell[2403, 68, 673, 21, 52, "Input"],
Cell[CellGroupData[{
Cell[3101, 93, 164, 4, 52, "Input"],
Cell[3268, 99, 3032, 74, 101, "Output"]
}, Open  ]],
Cell[6315, 176, 242, 7, 31, "Input"],
Cell[6560, 185, 1340, 39, 72, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7937, 229, 40, 0, 43, "Subsection"],
Cell[7980, 231, 976, 28, 52, "Input"],
Cell[CellGroupData[{
Cell[8981, 263, 316, 10, 52, "Input"],
Cell[9300, 275, 933, 29, 101, "Output"]
}, Open  ]],
Cell[10248, 307, 880, 27, 31, "Input"],
Cell[CellGroupData[{
Cell[11153, 338, 112, 3, 31, "Input"],
Cell[11268, 343, 11728, 199, 476, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[23045, 548, 46, 0, 43, "Subsection"],
Cell[CellGroupData[{
Cell[23116, 552, 222, 6, 52, "Input"],
Cell[23341, 560, 75, 2, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23453, 567, 551, 16, 52, "Input"],
Cell[24007, 585, 1155, 29, 86, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[25211, 620, 77, 0, 43, "Subsection"],
Cell[CellGroupData[{
Cell[25313, 624, 620, 18, 72, "Input"],
Cell[25936, 644, 74, 2, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26047, 651, 140, 4, 31, "Input"],
Cell[26190, 657, 6026, 136, 476, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32253, 798, 618, 18, 72, "Input"],
Cell[32874, 818, 74, 2, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32985, 825, 140, 4, 31, "Input"],
Cell[33128, 831, 5936, 117, 101, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39101, 953, 1448, 42, 72, "Input"],
Cell[40552, 997, 74, 2, 31, "Output"]
}, Open  ]],
Cell[40641, 1002, 219, 4, 31, "Input"],
Cell[40863, 1008, 1084, 33, 72, "Input"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

(* NotebookSignature Ov0GwBMg#KTS5Bw9vpxj5LaE *)
