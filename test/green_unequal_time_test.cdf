(* Content-type: application/vnd.wolfram.cdf.text *)

(*** Wolfram CDF File ***)
(* http://www.wolfram.com/cdf *)

(* CreatedBy='Mathematica 10.0' *)

(*************************************************************************)
(*                                                                       *)
(*  The Mathematica License under which this file was created prohibits  *)
(*  restricting third parties in receipt of this file from republishing  *)
(*  or redistributing it by any means, including but not limited to      *)
(*  rights management or terms of use, without the express consent of    *)
(*  Wolfram Research, Inc. For additional information concerning CDF     *)
(*  licensing and redistribution see:                                    *)
(*                                                                       *)
(*        www.wolfram.com/cdf/adopting-cdf/licensing-options.html        *)
(*                                                                       *)
(*************************************************************************)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[      1064,         20]
NotebookDataLength[     62253,       1581]
NotebookOptionsPosition[     60513,       1499]
NotebookOutlinePosition[     60857,       1514]
CellTagsIndexPosition[     60814,       1511]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "Reference:\n\tR. Blankenbecler, D. J. Scalapino, R. L. Sugar\n\tMonte Carlo \
calculations of coupled boson-fermion systems. I\n\tPhys. Rev. D 24, 2278 \
(1981) ",
 Cell[BoxData[
  FormBox[
   ButtonBox["DOI",
    BaseStyle->"Hyperlink",
    ButtonData->{
      URL["http://dx.doi.org/10.1103/PhysRevD.24.2278"], None},
    ButtonNote->"http://dx.doi.org/10.1103/PhysRevD.24.2278"], 
   TraditionalForm]]]
}], "Text"],

Cell[CellGroupData[{

Cell["Random B matrices", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"block", " ", "size"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    SubscriptBox["n", "val"], "=", "5"}], ";"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"number", " ", "of", " ", "time", " ", "steps"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    SubscriptBox["L", "val"], "=", "4"}], ";"}]}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SeedRandom", "[", "42", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     SubscriptBox["B", "i"], "=", 
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
       RowBox[{
        SubscriptBox["n", "val"], 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}]}], ",", 
       RowBox[{"WorkingPrecision", "\[Rule]", 
        RowBox[{"2", "MachinePrecision"}]}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      SubscriptBox["L", "val"]}], "}"}]}], "]"}], ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "example", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   SubscriptBox["B", "2"], "//", "MatrixForm"}]}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.4701525469139628219065106903090759682669696173526096406719`31.\
909179540382006", 
      "0.2400277101007709609625699323384271286132487890617430971973`31.\
909179540382006", 
      "0.9780450824885695825181112102879153516802217188427728512453`31.\
909179540382006", 
      "0.0954956615833911023522757287769700226325615442677395657806`31.\
909179540382006", 
      RowBox[{
      "-", "0.5030931329013885931729054825463520161931724256141502146361`31.\
909179540382006"}]},
     {"0.309395027057995638327872323664835265615158576470973504565`31.\
909179540382006", 
      "0.9671894507789101022533517264464769768119203967216328329837`31.\
909179540382006", 
      "0.6098839943358871857726699973376679352930084058301908131189`31.\
909179540382006", 
      RowBox[{
      "-", "0.8158748554153668595399117341092147460119892082259535614827`31.\
909179540382006"}], 
      "0.6234189541137121184505227255206447500510517703641820934075`31.\
909179540382006"},
     {"0.8921899858622822639709473692332970746861280726343358859515`31.\
909179540382006", 
      RowBox[{
      "-", "0.8020320552426841667785952998915136898696000364887285035354`31.\
909179540382006"}], 
      "0.3394722655565544032037734677392400538766276868277947190183`31.\
909179540382006", 
      RowBox[{
      "-", "0.5197864144383457326073902380742009002150087741785634241745`31.\
909179540382006"}], 
      "0.9698553608919895718612549337681935672908128543784921984114`31.\
909179540382006"},
     {
      RowBox[{
      "-", "0.9710982609457023088663440964314586636934221891780825448148`31.\
909179540382006"}], 
      "0.6443423420123493111246383533866200033772334660975786611291`31.\
909179540382006", 
      RowBox[{
      "-", "0.6585616448737773794672615528564197605955609364898819756948`31.\
909179540382006"}], 
      "0.8952638519896262542526840305543323810810064802425164652866`31.\
909179540382006", 
      RowBox[{
      "-", "0.5517645415911625574551826380200463933648767285575877454512`31.\
909179540382006"}]},
     {"0.3131854236727004256936920540150418903172773261100870054189`31.\
909179540382006", 
      RowBox[{
      "-", "0.4439637951821276937788534844679275752840940444946285316205`31.\
909179540382006"}], 
      "0.2674727376935182461972487292732353257948546466032845690093`31.\
909179540382006", 
      "0.518473878365793755666898099383364108513357457998456566118`31.\
909179540382006", 
      "0.2108326811540198831125728486213025659441526346284179866955`31.\
909179540382006"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["fn", "base"], "=", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
    RowBox[{"FileBaseName", "[", 
     RowBox[{"NotebookFileName", "[", "]"}], "]"}]}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"save", " ", "to", " ", "disk"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["fn", "base"], "<>", "\"\<_B\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"i", "-", "1"}], "]"}], "<>", "\"\<.dat\>\""}], ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Transpose", "[", 
         SubscriptBox["B", "i"], "]"}], "]"}], ",", "\"\<Real64\>\""}], "]"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       SubscriptBox["L", "val"]}], "}"}]}], "]"}], ";"}]}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Construct H matrix", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"cyclically", " ", "shifted", " ", "Eq", " ", 
     RowBox[{"(", "45", ")"}]}], ",", " ", 
    RowBox[{"symbolic", " ", "version"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Op", "[", "L_", "]"}], ":=", 
   RowBox[{
    RowBox[{"IdentityMatrix", "[", "L", "]"}], "+", 
    RowBox[{"RotateRight", "[", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", "\[Equal]", "L"}], ",", "1", ",", 
           RowBox[{"-", "1"}]}], "]"}], 
         SubscriptBox["b", "i"]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "L"}], "}"}]}], "]"}], "]"}], "]"}]}]}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "example", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Op", "[", "5", "]"}], "//", "MatrixForm"}]}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", 
      SubscriptBox["b", "5"]},
     {
      RowBox[{"-", 
       SubscriptBox["b", "1"]}], "1", "0", "0", "0"},
     {"0", 
      RowBox[{"-", 
       SubscriptBox["b", "2"]}], "1", "0", "0"},
     {"0", "0", 
      RowBox[{"-", 
       SubscriptBox["b", "3"]}], "1", "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       SubscriptBox["b", "4"]}], "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["H", "val"], "=", 
   RowBox[{"ArrayFlatten", "[", 
    RowBox[{
     RowBox[{"Op", "[", 
      SubscriptBox["L", "val"], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0", "\[Rule]", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{
           SubscriptBox["n", "val"], 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}]}], ",", 
       RowBox[{"1", "\[Rule]", 
        RowBox[{"IdentityMatrix", "[", 
         SubscriptBox["n", "val"], "]"}]}], ",", 
       RowBox[{
        SubscriptBox["b", "i_"], "\[RuleDelayed]", 
        SubscriptBox["B", "i"]}]}], "}"}]}], "]"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"N", "[", 
   SubscriptBox["H", "val"], "]"}], "//", "MatrixForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.7547569016548558`"}], 
      RowBox[{"-", "0.5686391233416268`"}], "0.9312739681001516`", 
      "0.17368769337781817`", 
      RowBox[{"-", "0.6014329585002102`"}]},
     {"0.`", "1.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.22039418349422105`", 
      RowBox[{"-", "0.5427940664200066`"}], 
      RowBox[{"-", "0.13276827094080584`"}], 
      RowBox[{"-", "0.9660637243152974`"}], "0.6372338915130267`"},
     {"0.`", "0.`", "1.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.29219200116600674`", 
      RowBox[{"-", "0.4675091568355077`"}], "0.1121099671081528`", 
      RowBox[{"-", "0.31718502666936416`"}], 
      RowBox[{"-", "0.27658451880847906`"}]},
     {"0.`", "0.`", "0.`", "1.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.4442538088053955`"}], 
      RowBox[{"-", "0.5721942324833684`"}], 
      RowBox[{"-", "0.7504317565604062`"}], 
      RowBox[{"-", "0.4693507828588377`"}], "0.8872773194983838`"},
     {"0.`", "0.`", "0.`", "0.`", "1.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.5200295228687075`", 
      RowBox[{"-", "0.604347647633128`"}], "0.6747436066471942`", 
      "0.07039779852939565`", "0.8050298761737186`"},
     {"0.14818943256807487`", "0.22344517192272403`", 
      RowBox[{"-", "0.7908269452198432`"}], 
      RowBox[{"-", "0.9965520185656148`"}], "0.513110639083837`", "1.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`"},
     {"0.9857479592521711`", "0.9877734855785923`", 
      RowBox[{"-", "0.9094578695948946`"}], 
      RowBox[{"-", "0.8428757457306598`"}], "0.044064720359607755`", "0.`", 
      "1.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`"},
     {
      RowBox[{"-", "0.8606215140816531`"}], "0.9350647072481315`", 
      RowBox[{"-", "0.9950327539971698`"}], "0.9170822821730071`", 
      RowBox[{"-", "0.09146856076958794`"}], "0.`", "0.`", "1.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`"},
     {"0.44125448507560616`", 
      RowBox[{"-", "0.3023452009777999`"}], 
      RowBox[{"-", "0.46159247475054227`"}], "0.8649963526990475`", 
      "0.8370678837961374`", "0.`", "0.`", "0.`", "1.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.5225551652464618`", "0.7223353953785538`", "0.2699662724355662`", 
      RowBox[{"-", "0.5570803964160375`"}], 
      RowBox[{"-", "0.23494615192458695`"}], "0.`", "0.`", "0.`", "0.`", 
      "1.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.4701525469139628`"}], 
      RowBox[{"-", "0.24002771010077095`"}], 
      RowBox[{"-", "0.9780450824885696`"}], 
      RowBox[{"-", "0.09549566158339111`"}], "0.5030931329013886`", "1.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.30939502705799565`"}], 
      RowBox[{"-", "0.96718945077891`"}], 
      RowBox[{"-", "0.6098839943358871`"}], "0.8158748554153669`", 
      RowBox[{"-", "0.6234189541137121`"}], "0.`", "1.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.8921899858622823`"}], "0.8020320552426842`", 
      RowBox[{"-", "0.3394722655565544`"}], "0.5197864144383457`", 
      RowBox[{"-", "0.9698553608919895`"}], "0.`", "0.`", "1.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.9710982609457023`", 
      RowBox[{"-", "0.6443423420123493`"}], "0.6585616448737773`", 
      RowBox[{"-", "0.8952638519896262`"}], "0.5517645415911625`", "0.`", 
      "0.`", "0.`", "1.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.3131854236727004`"}], "0.4439637951821277`", 
      RowBox[{"-", "0.26747273769351826`"}], 
      RowBox[{"-", "0.5184738783657937`"}], 
      RowBox[{"-", "0.21083268115401987`"}], "0.`", "0.`", "0.`", "0.`", 
      "1.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.16992404407755252`", 
      RowBox[{"-", "0.7951926249697979`"}], "0.15138147082106881`", 
      "0.848770628169602`", "0.5957037473734683`", "1.`", "0.`", "0.`", "0.`",
       "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.9487599719092318`", 
      RowBox[{"-", "0.2716997086645923`"}], "0.21851237380405295`", 
      RowBox[{"-", "0.7014806580427522`"}], 
      RowBox[{"-", "0.8465592522642582`"}], "0.`", "1.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.005831282137754713`", 
      RowBox[{"-", "0.6713008486973747`"}], 
      RowBox[{"-", "0.44555165234067473`"}], "0.4516839236888155`", 
      RowBox[{"-", "0.6352768473669813`"}], "0.`", "0.`", "1.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.19982712403073793`"}], "0.13000456980034894`", 
      "0.8832421789913679`", 
      RowBox[{"-", "0.9291069516953159`"}], 
      RowBox[{"-", "0.28024016117099765`"}], "0.`", "0.`", "0.`", "1.`", 
      "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.753646487537347`"}], "0.8157398347033145`", 
      RowBox[{"-", "0.8946309731687639`"}], "0.013262726986897854`", 
      "0.7682423165826436`", "0.`", "0.`", "0.`", "0.`", "1.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute inverse H matrix", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["invH", "val"], "=", 
   RowBox[{"Inverse", "[", 
    SubscriptBox["H", "val"], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "%", "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"20", ",", "20"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"no", " ", "obvious", " ", "block", " ", "structure"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"N", "[", 
    SubscriptBox["invH", "val"], "]"}], "//", "MatrixForm"}]}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.3135467220900107`", "0.24412261547816821`", 
      RowBox[{"-", "0.3256487747039597`"}], 
      RowBox[{"-", "0.004325188808707405`"}], "0.06863597522279502`", 
      RowBox[{"-", "0.5528120228153907`"}], "0.4564143941547697`", 
      RowBox[{"-", "0.41907726970422965`"}], "0.13288678343664967`", 
      RowBox[{"-", "0.19297327822749566`"}], 
      RowBox[{"-", "0.2942153341611097`"}], "0.14103623775525573`", 
      RowBox[{"-", "0.3609852754290806`"}], "0.125315218312356`", 
      RowBox[{"-", "0.045854644803432154`"}], "0.24038610008710687`", 
      "0.1975645983281804`", 
      RowBox[{"-", "0.27263513359285485`"}], "0.07122602857413747`", 
      RowBox[{"-", "0.1084716499270733`"}]},
     {
      RowBox[{"-", "0.7072912560092053`"}], 
      RowBox[{"-", "0.6348517103192586`"}], "0.7427128519677653`", 
      "0.8898658225674295`", "0.10786601691241594`", "0.2895627200151166`", 
      "0.44752942520177685`", "0.39022376814178666`", "0.010517551937904794`",
       "1.060986462897313`", 
      RowBox[{"-", "0.6163811331845407`"}], "1.1047240043589073`", 
      RowBox[{"-", "0.2691185506081997`"}], "0.015999356079772153`", 
      "1.574791008391423`", 
      RowBox[{"-", "0.27169731943291464`"}], "0.17480250294991165`", 
      "1.0861299243446192`", "0.15518366523723262`", 
      RowBox[{"-", "0.6918094979473343`"}]},
     {
      RowBox[{"-", "0.3694985043355997`"}], 
      RowBox[{"-", "0.9183327423764048`"}], "1.0498989632516902`", 
      "0.8387480651474014`", "0.19393407892006498`", "0.3083329318144446`", 
      RowBox[{"-", "0.0011883458193502911`"}], "0.1291164531559645`", 
      RowBox[{"-", "0.13926762989584243`"}], "0.9521503726500091`", 
      RowBox[{"-", "0.5526276315477275`"}], "0.6350078785748494`", 
      "0.07883608740630632`", 
      RowBox[{"-", "0.010509808039751418`"}], "0.9296126016179147`", 
      RowBox[{"-", "0.11149285441990572`"}], "0.3793909197048749`", 
      "0.6030421537268907`", 
      RowBox[{"-", "0.10996384689463143`"}], 
      RowBox[{"-", "0.24697489446445262`"}]},
     {
      RowBox[{"-", "0.09390576637230288`"}], "0.5505125736798492`", 
      "0.46815789014366865`", 
      RowBox[{"-", "0.18565646189508017`"}], 
      RowBox[{"-", "0.628904631884851`"}], 
      RowBox[{"-", "0.29572644058905584`"}], "0.16655711360677783`", 
      "0.03432274876025288`", "0.751194489381443`", 
      RowBox[{"-", "0.6284180091904921`"}], "0.4599374388362961`", 
      RowBox[{"-", "0.21499840915209334`"}], 
      RowBox[{"-", "0.032918687921547674`"}], "0.4808660858548896`", 
      "0.16249218298223447`", 
      RowBox[{"-", "0.08442739991411465`"}], 
      RowBox[{"-", "0.022024025281505495`"}], "0.39308430728863325`", 
      "0.6537686718747047`", "0.39321771801855393`"},
     {
      RowBox[{"-", "0.9687823521289054`"}], 
      RowBox[{"-", "0.9187425635239355`"}], "0.021078061039874422`", 
      "0.6682914306568885`", "1.0401290816186473`", 
      RowBox[{"-", "0.0013676395513211948`"}], "0.2768684712768801`", 
      RowBox[{"-", "0.05070829985710542`"}], "0.2289511555097957`", 
      "1.0551921595186748`", 
      RowBox[{"-", "1.0095494247633026`"}], "0.9816414996056754`", 
      RowBox[{"-", "0.4733149548664433`"}], 
      RowBox[{"-", "0.039777996227808546`"}], "1.7664235737645348`", 
      RowBox[{"-", "0.7788753067520935`"}], 
      RowBox[{"-", "0.028729306976273274`"}], "0.5775455272559196`", 
      RowBox[{"-", "0.4721723365011306`"}], 
      RowBox[{"-", "1.4216686867776662`"}]},
     {"0.22287768282203047`", "0.3994668808137793`", "1.1683188091998034`", 
      RowBox[{"-", "0.0628144692067501`"}], 
      RowBox[{"-", "1.0413424498983996`"}], "0.9670524678910952`", 
      RowBox[{"-", "0.14465518580231548`"}], "0.1372413487721102`", 
      "0.49894800345304713`", 
      RowBox[{"-", "0.6231710903043485`"}], "0.7206563036087663`", 
      RowBox[{"-", "0.4835117801645412`"}], "0.3860309001988313`", 
      "0.46916177223368816`", 
      RowBox[{"-", "0.3543603957179806`"}], "0.2524281316152643`", 
      "0.22449002724020167`", "0.3699973476449372`", "0.7615987803301869`", 
      "1.0966766821888374`"},
     {"0.01706041584190232`", "0.05575920747045468`", "0.9358845588430447`", 
      RowBox[{"-", "0.2978496945374814`"}], 
      RowBox[{"-", "0.57375154746455`"}], "0.2901263779019065`", 
      "0.2351388112757197`", "0.17624210569370222`", "0.3550350702722739`", 
      RowBox[{"-", "0.5680256775224167`"}], "0.8284311819739077`", 
      RowBox[{"-", "0.8772030541296154`"}], "0.6864768949400164`", 
      "0.258171978925509`", 
      RowBox[{"-", "0.605768425571409`"}], 
      RowBox[{"-", "0.10682363828629994`"}], 
      RowBox[{"-", "0.03967168752583694`"}], "0.05021246429032977`", 
      "0.24834719065311345`", "0.9597426357693434`"},
     {"0.5610512186586777`", 
      RowBox[{"-", "0.6989479415610681`"}], 
      RowBox[{"-", "0.35747238661924224`"}], "0.23016722887478683`", 
      "0.8230750572206043`", 
      RowBox[{"-", "0.16864005079458158`"}], 
      RowBox[{"-", "0.15427318429689532`"}], "0.36680871211079835`", 
      RowBox[{"-", "0.7020105441757177`"}], "0.4620807865021771`", 
      RowBox[{"-", "0.7408769056248311`"}], "0.007204597869094629`", 
      "0.006311761337676335`", 
      RowBox[{"-", "0.3622012670258726`"}], 
      RowBox[{"-", "0.5744464799414818`"}], "0.35618125115592986`", 
      "0.4016530991772649`", 
      RowBox[{"-", "0.9578541216636639`"}], 
      RowBox[{"-", "0.8359743350379779`"}], 
      RowBox[{"-", "0.18286549023475718`"}]},
     {"0.3694069953812291`", 
      RowBox[{"-", "0.43070152507929854`"}], "0.4302764741691349`", 
      "0.25930183378688304`", 
      RowBox[{"-", "0.2348130843647653`"}], "0.7307499439442031`", 
      RowBox[{"-", "0.4424640570829139`"}], "0.3752584283587105`", 
      "0.03882999950166681`", "0.5057517546768059`", "0.13559239563444553`", 
      RowBox[{"-", "0.07083774615607709`"}], "0.5389811068712663`", 
      RowBox[{"-", "0.4379603491784078`"}], 
      RowBox[{"-", "0.693705335449125`"}], "0.4853188097065856`", 
      "0.18389750803961327`", 
      RowBox[{"-", "0.09641393853523318`"}], 
      RowBox[{"-", "0.20553547050746215`"}], "0.574597874799057`"},
     {"0.16688343652739918`", "0.6697519276918137`", 
      RowBox[{"-", "0.38400184948627725`"}], 
      RowBox[{"-", "0.8133681950785348`"}], 
      RowBox[{"-", "0.27211330214015345`"}], 
      RowBox[{"-", "0.16859084059141444`"}], 
      RowBox[{"-", "0.4036123453741367`"}], 
      RowBox[{"-", "0.09053172493070924`"}], "0.4328266046944977`", 
      RowBox[{"-", "0.02476339603327057`"}], "0.767200852064856`", 
      RowBox[{"-", "0.9322496810422075`"}], "0.23220360724911307`", 
      "0.18433166047378677`", 
      RowBox[{"-", "0.8589941220252475`"}], 
      RowBox[{"-", "0.12928570285017674`"}], 
      RowBox[{"-", "0.3509461816523782`"}], 
      RowBox[{"-", "0.4502125724911979`"}], "0.13363898391814671`", 
      "0.5081140947838524`"},
     {"0.6089337227158416`", 
      RowBox[{"-", "0.8604861935024108`"}], "0.6585804115346685`", 
      "0.5580515171680311`", "0.29217313993754407`", "0.5139633220363851`", 
      RowBox[{"-", "0.001655101410426557`"}], "0.5469642568172601`", 
      RowBox[{"-", "0.5808420271293098`"}], "0.08336385592849811`", 
      "0.44002882719768666`", "0.03141280148137177`", "0.28709039232332595`", 
      RowBox[{"-", "0.20626244289452997`"}], 
      RowBox[{"-", "0.507931011432221`"}], "0.552789006974887`", 
      "0.682977120468778`", 
      RowBox[{"-", "0.533525194545844`"}], 
      RowBox[{"-", "0.4868033745214171`"}], "0.36636236132324956`"},
     {"0.23028247771083427`", "0.520180211993782`", "0.4581872274926366`", 
      RowBox[{"-", "0.8857632535978821`"}], 
      RowBox[{"-", "0.35319481496770544`"}], 
      RowBox[{"-", "0.2243457015894353`"}], "0.19795514912976775`", 
      "0.07402894947519578`", "0.30776509988701584`", 
      RowBox[{"-", "0.8884469138182552`"}], "0.9400295365480772`", 
      RowBox[{"-", "0.5170110967512207`"}], "0.49225769135006714`", 
      "0.6461934657772372`", 
      RowBox[{"-", "1.0154123656503464`"}], 
      RowBox[{"-", "0.2845480146229269`"}], 
      RowBox[{"-", "0.09277599745272803`"}], 
      RowBox[{"-", "0.6231489354749635`"}], "0.21699058942869084`", 
      "1.0040005284449063`"},
     {"0.34546762255888147`", "0.9478415367053833`", 
      RowBox[{"-", "0.4256771533379645`"}], 
      RowBox[{"-", "0.6626531219045477`"}], 
      RowBox[{"-", "0.33135491210869417`"}], "0.02951262864160113`", 
      RowBox[{"-", "0.531479030772876`"}], 
      RowBox[{"-", "0.17724198842216446`"}], "0.32168969186318735`", 
      RowBox[{"-", "0.23044839676656678`"}], "0.40062158627568834`", 
      RowBox[{"-", "0.5927204915467398`"}], "0.7410279527047791`", 
      "0.49498283602610776`", 
      RowBox[{"-", "0.49784119430138196`"}], "0.05415293366619419`", 
      RowBox[{"-", "0.06749865513172142`"}], 
      RowBox[{"-", "0.421855407881456`"}], "0.4329633260919263`", 
      "0.34075084233053765`"},
     {
      RowBox[{"-", "0.33629382852888684`"}], 
      RowBox[{"-", "0.6468301406207726`"}], "0.30098486572009087`", 
      "0.3984338310654977`", "0.039430567791230005`", "0.10613406677954038`", 
      "0.22015959835016896`", "0.1246267689895524`", "0.002498530710166533`", 
      "0.40129351176780975`", "0.019955062400659043`", "0.3505375511417678`", 
      "0.4177040954176169`", "0.4554830752461721`", "0.18501812391098463`", 
      RowBox[{"-", "0.04270716994712252`"}], 
      RowBox[{"-", "0.1498008983059923`"}], "0.46595164157911134`", 
      RowBox[{"-", "0.2867717372518407`"}], 
      RowBox[{"-", "0.09209243703967158`"}]},
     {"0.43900609995220136`", 
      RowBox[{"-", "0.16869927999123097`"}], 
      RowBox[{"-", "0.003085584414432251`"}], "0.13708199356091`", 
      RowBox[{"-", "0.030373050583290203`"}], "0.4722848115960674`", 
      RowBox[{"-", "0.5054616142924551`"}], "0.23832285272800263`", 
      RowBox[{"-", "0.07774182352803424`"}], "0.4376068871749327`", 
      RowBox[{"-", "0.10820664820363189`"}], "0.006668368107850295`", 
      "0.14622032146716823`", 
      RowBox[{"-", "0.2527712102625833`"}], "0.46353783634859247`", 
      "0.4461188877230219`", "0.21670618108336434`", 
      RowBox[{"-", "0.3075222367526787`"}], 
      RowBox[{"-", "0.17372517588256087`"}], "0.2735016806495058`"},
     {"0.05126779560101712`", "1.065880334217455`", "0.06324907149823025`", 
      RowBox[{"-", "1.1187045634321542`"}], 
      RowBox[{"-", "0.2957183273317323`"}], 
      RowBox[{"-", "0.6416257492931264`"}], "0.35239017077497803`", 
      RowBox[{"-", "0.25499330838554296`"}], "0.33892412129396604`", 
      RowBox[{"-", "1.2870565484539385`"}], "0.6596082268922464`", 
      RowBox[{"-", "0.6282326509818494`"}], 
      RowBox[{"-", "0.21116073702990446`"}], "0.23794209826310236`", 
      RowBox[{"-", "1.0789439760815998`"}], "0.4420935212602763`", 
      RowBox[{"-", "0.18155705917364434`"}], 
      RowBox[{"-", "0.5532975056395799`"}], "0.5366184552103345`", 
      "0.5997760575157857`"},
     {
      RowBox[{"-", "0.45491215024883164`"}], "0.1540597956404102`", 
      RowBox[{"-", "0.19880673964242662`"}], 
      RowBox[{"-", "0.22977899705442428`"}], 
      RowBox[{"-", "0.2988127663014257`"}], 
      RowBox[{"-", "0.08076329131549474`"}], 
      RowBox[{"-", "0.10197611136246568`"}], 
      RowBox[{"-", "0.1709168973768273`"}], "0.5003457860931723`", 
      "0.38183256485512823`", 
      RowBox[{"-", "0.3272220092185407`"}], "0.21078226935828534`", 
      "0.11623813149873802`", "0.36863101202405235`", "0.8370007088072473`", 
      RowBox[{"-", "0.26590096315310396`"}], "0.4199329161517275`", 
      "0.4955788602962737`", "0.07797450976244545`", "0.017672746934869372`"},
     {"0.7357505555831518`", "0.9615195475230391`", 
      RowBox[{"-", "0.02383027800384518`"}], 
      RowBox[{"-", "0.9859951125683678`"}], 
      RowBox[{"-", "0.4235449010493012`"}], "0.11164142988835922`", 
      RowBox[{"-", "0.5244548613804498`"}], "0.06264481542715337`", 
      "0.30280327352777325`", 
      RowBox[{"-", "0.6028342536669502`"}], "0.7292197439561281`", 
      RowBox[{"-", "0.7654366759594019`"}], "0.5631652897462087`", 
      "0.2892193368078142`", 
      RowBox[{"-", "0.6895941173797573`"}], "0.13258627933513112`", 
      "0.1089937016059793`", 
      RowBox[{"-", "0.008992270119825129`"}], "0.3605787814504632`", 
      "1.0390181041177293`"},
     {
      RowBox[{"-", "0.4028136693243572`"}], 
      RowBox[{"-", "1.7249986038438314`"}], "0.7267942390648346`", 
      "1.220553809974735`", "0.4250911588921255`", "0.336766051469198`", 
      "0.5062600581253714`", "0.4388010248156105`", 
      RowBox[{"-", "0.4596737445114937`"}], "0.831181878550004`", 
      RowBox[{"-", "0.39990778461653226`"}], "0.9245622936288574`", 
      RowBox[{"-", "0.2320658603419877`"}], 
      RowBox[{"-", "0.2100588060529562`"}], "0.7720277388747271`", 
      "0.1849655250699129`", "0.12970503576349238`", "0.6937387218842017`", 
      "0.17697585599152624`", 
      RowBox[{"-", "0.3671986046230019`"}]},
     {"0.247333316347047`", 
      RowBox[{"-", "0.08668506383446545`"}], 
      RowBox[{"-", "0.2598701288331412`"}], "0.4396994211132293`", 
      "0.2346808790486955`", "0.23252048469005043`", 
      RowBox[{"-", "0.2528077796522272`"}], "0.008520564075446864`", 
      RowBox[{"-", "0.3413208219075782`"}], "0.23989176732042056`", 
      "0.00607938841596079`", 
      RowBox[{"-", "0.09461742246821378`"}], "0.35988448260615874`", 
      RowBox[{"-", "0.051599147798566135`"}], 
      RowBox[{"-", "0.3584354855924237`"}], "0.35501054137506016`", 
      "0.36552190705147747`", 
      RowBox[{"-", "0.04109508719956137`"}], 
      RowBox[{"-", "0.0192767122866484`"}], "0.5530565714623047`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Extract unequal time Green\[CloseCurlyQuote]s functions", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"G", 
    RowBox[{"(", 
     RowBox[{"\[Tau]", ",", "0"}], ")"}], " ", "is", " ", "the", " ", "first",
     " ", "block", " ", "column"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["G", 
      RowBox[{"\[Tau]", ",", "0"}]], "=", 
     RowBox[{
      SubscriptBox["invH", "val"], "\[LeftDoubleBracket]", 
      RowBox[{";;", ",", 
       RowBox[{"1", ";;", 
        SubscriptBox["n", "val"]}]}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Dimensions", "[", "%", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"20", ",", "5"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"N", "[", 
   SubscriptBox["G", 
    RowBox[{"\[Tau]", ",", "0"}]], "]"}], "//", "MatrixForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.3135467220900107`", "0.24412261547816821`", 
      RowBox[{"-", "0.3256487747039597`"}], 
      RowBox[{"-", "0.004325188808707405`"}], "0.06863597522279502`"},
     {
      RowBox[{"-", "0.7072912560092053`"}], 
      RowBox[{"-", "0.6348517103192586`"}], "0.7427128519677653`", 
      "0.8898658225674295`", "0.10786601691241594`"},
     {
      RowBox[{"-", "0.3694985043355997`"}], 
      RowBox[{"-", "0.9183327423764048`"}], "1.0498989632516902`", 
      "0.8387480651474014`", "0.19393407892006498`"},
     {
      RowBox[{"-", "0.09390576637230288`"}], "0.5505125736798492`", 
      "0.46815789014366865`", 
      RowBox[{"-", "0.18565646189508017`"}], 
      RowBox[{"-", "0.628904631884851`"}]},
     {
      RowBox[{"-", "0.9687823521289054`"}], 
      RowBox[{"-", "0.9187425635239355`"}], "0.021078061039874422`", 
      "0.6682914306568885`", "1.0401290816186473`"},
     {"0.22287768282203047`", "0.3994668808137793`", "1.1683188091998034`", 
      RowBox[{"-", "0.0628144692067501`"}], 
      RowBox[{"-", "1.0413424498983996`"}]},
     {"0.01706041584190232`", "0.05575920747045468`", "0.9358845588430447`", 
      RowBox[{"-", "0.2978496945374814`"}], 
      RowBox[{"-", "0.57375154746455`"}]},
     {"0.5610512186586777`", 
      RowBox[{"-", "0.6989479415610681`"}], 
      RowBox[{"-", "0.35747238661924224`"}], "0.23016722887478683`", 
      "0.8230750572206043`"},
     {"0.3694069953812291`", 
      RowBox[{"-", "0.43070152507929854`"}], "0.4302764741691349`", 
      "0.25930183378688304`", 
      RowBox[{"-", "0.2348130843647653`"}]},
     {"0.16688343652739918`", "0.6697519276918137`", 
      RowBox[{"-", "0.38400184948627725`"}], 
      RowBox[{"-", "0.8133681950785348`"}], 
      RowBox[{"-", "0.27211330214015345`"}]},
     {"0.6089337227158416`", 
      RowBox[{"-", "0.8604861935024108`"}], "0.6585804115346685`", 
      "0.5580515171680311`", "0.29217313993754407`"},
     {"0.23028247771083427`", "0.520180211993782`", "0.4581872274926366`", 
      RowBox[{"-", "0.8857632535978821`"}], 
      RowBox[{"-", "0.35319481496770544`"}]},
     {"0.34546762255888147`", "0.9478415367053833`", 
      RowBox[{"-", "0.4256771533379645`"}], 
      RowBox[{"-", "0.6626531219045477`"}], 
      RowBox[{"-", "0.33135491210869417`"}]},
     {
      RowBox[{"-", "0.33629382852888684`"}], 
      RowBox[{"-", "0.6468301406207726`"}], "0.30098486572009087`", 
      "0.3984338310654977`", "0.039430567791230005`"},
     {"0.43900609995220136`", 
      RowBox[{"-", "0.16869927999123097`"}], 
      RowBox[{"-", "0.003085584414432251`"}], "0.13708199356091`", 
      RowBox[{"-", "0.030373050583290203`"}]},
     {"0.05126779560101712`", "1.065880334217455`", "0.06324907149823025`", 
      RowBox[{"-", "1.1187045634321542`"}], 
      RowBox[{"-", "0.2957183273317323`"}]},
     {
      RowBox[{"-", "0.45491215024883164`"}], "0.1540597956404102`", 
      RowBox[{"-", "0.19880673964242662`"}], 
      RowBox[{"-", "0.22977899705442428`"}], 
      RowBox[{"-", "0.2988127663014257`"}]},
     {"0.7357505555831518`", "0.9615195475230391`", 
      RowBox[{"-", "0.02383027800384518`"}], 
      RowBox[{"-", "0.9859951125683678`"}], 
      RowBox[{"-", "0.4235449010493012`"}]},
     {
      RowBox[{"-", "0.4028136693243572`"}], 
      RowBox[{"-", "1.7249986038438314`"}], "0.7267942390648346`", 
      "1.220553809974735`", "0.4250911588921255`"},
     {"0.247333316347047`", 
      RowBox[{"-", "0.08668506383446545`"}], 
      RowBox[{"-", "0.2598701288331412`"}], "0.4396994211132293`", 
      "0.2346808790486955`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"G", 
    RowBox[{"(", 
     RowBox[{"0", ",", "\[Tau]"}], ")"}], " ", "is", " ", "the", " ", "first",
     " ", "block", " ", "row"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["G", 
      RowBox[{"0", ",", "\[Tau]"}]], "=", 
     RowBox[{
      SubscriptBox["invH", "val"], "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"1", ";;", 
        SubscriptBox["n", "val"]}], ",", ";;"}], "\[RightDoubleBracket]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"Dimensions", "[", "%", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5", ",", "20"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"N", "[", 
   SubscriptBox["G", 
    RowBox[{"0", ",", "\[Tau]"}]], "]"}], "//", "MatrixForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.3135467220900107`", "0.24412261547816821`", 
      RowBox[{"-", "0.3256487747039597`"}], 
      RowBox[{"-", "0.004325188808707405`"}], "0.06863597522279502`", 
      RowBox[{"-", "0.5528120228153907`"}], "0.4564143941547697`", 
      RowBox[{"-", "0.41907726970422965`"}], "0.13288678343664967`", 
      RowBox[{"-", "0.19297327822749566`"}], 
      RowBox[{"-", "0.2942153341611097`"}], "0.14103623775525573`", 
      RowBox[{"-", "0.3609852754290806`"}], "0.125315218312356`", 
      RowBox[{"-", "0.045854644803432154`"}], "0.24038610008710687`", 
      "0.1975645983281804`", 
      RowBox[{"-", "0.27263513359285485`"}], "0.07122602857413747`", 
      RowBox[{"-", "0.1084716499270733`"}]},
     {
      RowBox[{"-", "0.7072912560092053`"}], 
      RowBox[{"-", "0.6348517103192586`"}], "0.7427128519677653`", 
      "0.8898658225674295`", "0.10786601691241594`", "0.2895627200151166`", 
      "0.44752942520177685`", "0.39022376814178666`", "0.010517551937904794`",
       "1.060986462897313`", 
      RowBox[{"-", "0.6163811331845407`"}], "1.1047240043589073`", 
      RowBox[{"-", "0.2691185506081997`"}], "0.015999356079772153`", 
      "1.574791008391423`", 
      RowBox[{"-", "0.27169731943291464`"}], "0.17480250294991165`", 
      "1.0861299243446192`", "0.15518366523723262`", 
      RowBox[{"-", "0.6918094979473343`"}]},
     {
      RowBox[{"-", "0.3694985043355997`"}], 
      RowBox[{"-", "0.9183327423764048`"}], "1.0498989632516902`", 
      "0.8387480651474014`", "0.19393407892006498`", "0.3083329318144446`", 
      RowBox[{"-", "0.0011883458193502911`"}], "0.1291164531559645`", 
      RowBox[{"-", "0.13926762989584243`"}], "0.9521503726500091`", 
      RowBox[{"-", "0.5526276315477275`"}], "0.6350078785748494`", 
      "0.07883608740630632`", 
      RowBox[{"-", "0.010509808039751418`"}], "0.9296126016179147`", 
      RowBox[{"-", "0.11149285441990572`"}], "0.3793909197048749`", 
      "0.6030421537268907`", 
      RowBox[{"-", "0.10996384689463143`"}], 
      RowBox[{"-", "0.24697489446445262`"}]},
     {
      RowBox[{"-", "0.09390576637230288`"}], "0.5505125736798492`", 
      "0.46815789014366865`", 
      RowBox[{"-", "0.18565646189508017`"}], 
      RowBox[{"-", "0.628904631884851`"}], 
      RowBox[{"-", "0.29572644058905584`"}], "0.16655711360677783`", 
      "0.03432274876025288`", "0.751194489381443`", 
      RowBox[{"-", "0.6284180091904921`"}], "0.4599374388362961`", 
      RowBox[{"-", "0.21499840915209334`"}], 
      RowBox[{"-", "0.032918687921547674`"}], "0.4808660858548896`", 
      "0.16249218298223447`", 
      RowBox[{"-", "0.08442739991411465`"}], 
      RowBox[{"-", "0.022024025281505495`"}], "0.39308430728863325`", 
      "0.6537686718747047`", "0.39321771801855393`"},
     {
      RowBox[{"-", "0.9687823521289054`"}], 
      RowBox[{"-", "0.9187425635239355`"}], "0.021078061039874422`", 
      "0.6682914306568885`", "1.0401290816186473`", 
      RowBox[{"-", "0.0013676395513211948`"}], "0.2768684712768801`", 
      RowBox[{"-", "0.05070829985710542`"}], "0.2289511555097957`", 
      "1.0551921595186748`", 
      RowBox[{"-", "1.0095494247633026`"}], "0.9816414996056754`", 
      RowBox[{"-", "0.4733149548664433`"}], 
      RowBox[{"-", "0.039777996227808546`"}], "1.7664235737645348`", 
      RowBox[{"-", "0.7788753067520935`"}], 
      RowBox[{"-", "0.028729306976273274`"}], "0.5775455272559196`", 
      RowBox[{"-", "0.4721723365011306`"}], 
      RowBox[{"-", "1.4216686867776662`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"G", 
    RowBox[{"(", 
     RowBox[{"\[Tau]", ",", "\[Tau]"}], ")"}], " ", "is", " ", "the", " ", 
    "block", " ", "diagonal"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"n", "=", 
         SubscriptBox["n", "val"]}], ",", 
        RowBox[{"L", "=", 
         SubscriptBox["L", "val"]}]}], "}"}], ",", 
      RowBox[{
       SubscriptBox["G", 
        RowBox[{"\[Tau]", ",", "\[Tau]"}]], "=", 
       RowBox[{"ArrayFlatten", "[", 
        RowBox[{"{", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            SubscriptBox["invH", "val"], "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"n", 
                RowBox[{"(", 
                 RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}], ";;", 
              RowBox[{"n", " ", "i"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"n", 
                RowBox[{"(", 
                 RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}], ";;", 
              RowBox[{"n", " ", "i"}]}]}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "L"}], "}"}]}], "]"}], "}"}], "]"}]}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"Dimensions", "[", "%", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5", ",", "20"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"compute", " ", "the", " ", "time"}], "-", 
    RowBox[{"averaged", " ", "unequal", " ", "time", " ", 
     RowBox[{"Green", "'"}], "s", " ", "function", " ", 
     SubscriptBox[
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"G", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Tau]", "+", 
           SuperscriptBox["\[Tau]", "\[Prime]",
            MultilineFunction->None]}], ",", 
          SuperscriptBox["\[Tau]", "\[Prime]",
           MultilineFunction->None]}], ")"}]}], "\[RightAngleBracket]"}], 
      SuperscriptBox["\[Tau]", "\[Prime]",
       MultilineFunction->None]], " ", 
     RowBox[{"(", 
      RowBox[{
      "average", " ", "over", " ", "cyclically", " ", "shifted", " ", 
       "column", " ", "blocks"}], ")"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"n", "=", 
         SubscriptBox["n", "val"]}], ",", 
        RowBox[{"L", "=", 
         SubscriptBox["L", "val"]}]}], "}"}], ",", 
      RowBox[{
       SubscriptBox["G", 
        RowBox[{"\[Tau]", ",", "0", ",", "avr"}]], "=", 
       RowBox[{
        FractionBox["1", "L"], 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"RotateLeft", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["invH", "val"], "\[LeftDoubleBracket]", 
             RowBox[{";;", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"n", 
                 RowBox[{"(", 
                  RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}], ";;", 
               RowBox[{"n", " ", "i"}]}]}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{"n", 
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "L"}], "}"}]}], "]"}]}]}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Dimensions", "[", "%", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"20", ",", "5"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"N", "[", 
   SubscriptBox["G", 
    RowBox[{"\[Tau]", ",", "0", ",", "avr"}]], "]"}], "//", 
  "MatrixForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.5406803846097672`", 
      RowBox[{"-", "0.012669207004104958`"}], 
      RowBox[{"-", "0.11365363481202587`"}], "0.20624470674003603`", 
      RowBox[{"-", "0.11567251724949718`"}]},
     {"0.06424092382191862`", 
      RowBox[{"-", "0.12419776991075801`"}], "0.47669787732695207`", 
      "0.49226721709484655`", 
      RowBox[{"-", "0.3644748198313695`"}]},
     {
      RowBox[{"-", "0.0012326723798404666`"}], 
      RowBox[{"-", "0.38908317915351515`"}], "0.5371858394868606`", 
      "0.24807478461206364`", "0.29929794380964736`"},
     {"0.21044119126061805`", "0.14707277587554884`", "0.4887147839510494`", 
      "0.12140811721107125`", 
      RowBox[{"-", "0.07633333948001561`"}]},
     {
      RowBox[{"-", "0.2226423248872229`"}], 
      RowBox[{"-", "0.2375411584346861`"}], "0.008917892594193011`", 
      "0.2072675282005386`", "0.5079900233490685`"},
     {"0.4092088329594422`", 
      RowBox[{"-", "0.008214068312579077`"}], "0.3078717988485761`", 
      RowBox[{"-", "0.08362209237470501`"}], 
      RowBox[{"-", "0.5363485549946436`"}]},
     {
      RowBox[{"-", "0.20155115359974707`"}], "0.15982478222710486`", 
      "0.5530703910403995`", "0.13343252065270486`", 
      RowBox[{"-", "0.3292518126057231`"}]},
     {"0.3020726842091253`", 
      RowBox[{"-", "0.40411818214711775`"}], "0.15787326710792318`", 
      "0.18277810266278924`", 
      RowBox[{"-", "0.08598558784754311`"}]},
     {
      RowBox[{"-", "0.002198530592469349`"}], "0.17299908540455558`", 
      "0.1789804225263332`", "0.1763775575796995`", "0.3329314710740814`"},
     {
      RowBox[{"-", "0.033406917553166535`"}], "0.010235895988717872`", 
      "0.19793775327595092`", 
      RowBox[{"-", "0.35372037572656645`"}], 
      RowBox[{"-", "0.4036526468338277`"}]},
     {
      RowBox[{"-", "0.01861980728078255`"}], 
      RowBox[{"-", "0.03564243943299386`"}], "0.10314979384124555`", 
      "0.445972409276135`", "0.013984657217252746`"},
     {
      RowBox[{"-", "0.1434213962688753`"}], "0.3708141043660967`", 
      "0.01709106094948483`", 
      RowBox[{"-", "0.030267730192956074`"}], "0.6407928485120473`"},
     {"0.06516566801386077`", "0.3650119132692619`", 
      RowBox[{"-", "0.3105125930420422`"}], 
      RowBox[{"-", "0.3015834978636259`"}], 
      RowBox[{"-", "0.04686051359812172`"}]},
     {"0.23643211787079824`", 
      RowBox[{"-", "0.04291774590197031`"}], "0.15261331601973013`", 
      "0.05352267547535787`", "0.4019256260306314`"},
     {
      RowBox[{"-", "0.11682713574280686`"}], "0.05229706457745974`", 
      RowBox[{"-", "0.22952313692415666`"}], 
      RowBox[{"-", "0.027594460164082495`"}], "0.6210140963213794`"},
     {"0.19297527084231994`", "0.43044001716911534`", 
      RowBox[{"-", "0.12583062313825305`"}], 
      RowBox[{"-", "0.25086484557080835`"}], 
      RowBox[{"-", "0.11917240998848976`"}]},
     {"0.09463343427931646`", 
      RowBox[{"-", "0.0920974576850391`"}], "0.06368624699110324`", 
      "0.06397528080942011`", "0.29010144986734615`"},
     {"0.08933987885973987`", "0.22500928611026552`", 
      RowBox[{"-", "0.07756436784791508`"}], 
      RowBox[{"-", "0.2636251708495391`"}], "0.07372745849744093`"},
     {
      RowBox[{"-", "0.1514137210565225`"}], 
      RowBox[{"-", "0.44477003367478074`"}], "0.4415124340688663`", 
      "0.31175405323148236`", 
      RowBox[{"-", "0.24728115569679082`"}]},
     {"0.36482135414590094`", 
      RowBox[{"-", "0.13134002312910714`"}], 
      RowBox[{"-", "0.09647426454845306`"}], "0.16981426530356272`", 
      "0.17609514929790715`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"compute", " ", "the", " ", "time"}], "-", 
    RowBox[{"averaged", " ", "unequal", " ", "time", " ", 
     RowBox[{"Green", "'"}], "s", " ", "function", " ", 
     SubscriptBox[
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"G", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Tau]", "\[Prime]",
           MultilineFunction->None], ",", 
          RowBox[{"\[Tau]", "+", 
           SuperscriptBox["\[Tau]", "\[Prime]",
            MultilineFunction->None]}]}], ")"}]}], "\[RightAngleBracket]"}], 
      SuperscriptBox["\[Tau]", "\[Prime]",
       MultilineFunction->None]], " ", 
     RowBox[{"(", 
      RowBox[{
      "average", " ", "over", " ", "cyclically", " ", "shifted", " ", "row", 
       " ", "blocks"}], ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"n", "=", 
         SubscriptBox["n", "val"]}], ",", 
        RowBox[{"L", "=", 
         SubscriptBox["L", "val"]}]}], "}"}], ",", 
      RowBox[{
       SubscriptBox["G", 
        RowBox[{"0", ",", "\[Tau]", ",", "avr"}]], "=", 
       RowBox[{
        FractionBox["1", "L"], 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"RotateLeft", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["invH", "val"], "\[LeftDoubleBracket]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"n", 
                 RowBox[{"(", 
                  RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}], ";;", 
               RowBox[{"n", " ", "i"}]}], ",", ";;"}], 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{"n", 
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "L"}], "}"}]}], "]"}]}]}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Dimensions", "[", "%", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5", ",", "20"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"N", "[", 
   SubscriptBox["G", 
    RowBox[{"0", ",", "\[Tau]", ",", "avr"}]], "]"}], "//", 
  "MatrixForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.29915648080722496`", "0.2122459092517479`", "0.39112487938218565`", 
      RowBox[{"-", "0.15694817606989514`"}], 
      RowBox[{"-", "0.2440629155174482`"}], "0.07164450445474081`", 
      "0.1656235694292514`", "0.0025337568748994284`", "0.09747922026358827`", 
      RowBox[{"-", "0.5049592652643211`"}], "0.3815195058843974`", 
      RowBox[{"-", "0.2348238479774408`"}], "0.025243820015793055`", 
      "0.15653916147865415`", 
      RowBox[{"-", "0.4967725070088084`"}], "0.3719241899843836`", 
      "0.23086867171587894`", 
      RowBox[{"-", "0.24736512153333542`"}], "0.22065997239831042`", 
      "0.48858586277519983`"},
     {
      RowBox[{"-", "0.22871512817632508`"}], "0.02378687619634708`", 
      "0.48449447466525497`", 
      RowBox[{"-", "0.13088153065558955`"}], 
      RowBox[{"-", "0.2794732779553163`"}], "0.06864502625302327`", 
      "0.19466181856119966`", "0.11739448148346435`", "0.2934158770475917`", 
      RowBox[{"-", "0.0034133908970577`"}], "0.20621439402972588`", 
      RowBox[{"-", "0.01967696929091087`"}], "0.25646354179515546`", 
      "0.3222489532016427`", "0.19765273149422868`", 
      RowBox[{"-", "0.23224248387381136`"}], "0.11557193353076856`", 
      "0.2521930783640648`", "0.17462398877037058`", "0.3224016033004462`"},
     {"0.31819272311627783`", "0.07302010007273735`", "0.06072978632265959`", 
      RowBox[{"-", "0.14493323511268183`"}], "0.06552733074566848`", 
      "0.07021173488745584`", 
      RowBox[{"-", "0.3028488555673929`"}], "0.09533199806793795`", 
      RowBox[{"-", "0.0541963021701499`"}], "0.1452371271796673`", 
      RowBox[{"-", "0.04091580173518556`"}], 
      RowBox[{"-", "0.1789861727655494`"}], "0.3473352727987426`", 
      "0.10287277444207449`", 
      RowBox[{"-", "0.2080672975011766`"}], "0.10785690243433736`", 
      "0.2056347663390994`", 
      RowBox[{"-", "0.1964149114845136`"}], 
      RowBox[{"-", "0.03809901859755497`"}], "0.23748214043726426`"},
     {
      RowBox[{"-", "0.11590156721107946`"}], 
      RowBox[{"-", "0.5630044239660134`"}], "0.48155336727443226`", 
      "0.4231582532330089`", 
      RowBox[{"-", "0.09979899739156521`"}], "0.21948090540097143`", 
      "0.11262817824985108`", "0.24325224273103158`", "0.08321231877044565`", 
      "0.27745228395103194`", "0.05389427806371712`", "0.2473159223656137`", 
      "0.17292516350633697`", "0.07208250146742443`", "0.10645817757970528`", 
      "0.13578744122881534`", "0.035444405053901964`", "0.3640901830541783`", 
      "0.084609330026732`", "0.12713113778873436`"},
     {
      RowBox[{"-", "0.02888987482556446`"}], 
      RowBox[{"-", "0.12609374491445458`"}], 
      RowBox[{"-", "0.15646987542349408`"}], "0.10792616256312325`", 
      "0.2430809019859748`", "0.13371170403584556`", 
      RowBox[{"-", "0.22125331701048473`"}], "0.02640084800390871`", 
      "0.06067877869217024`", "0.4269818544951894`", 
      RowBox[{"-", "0.0861189581215294`"}], 
      RowBox[{"-", "0.0096393089492239`"}], "0.06624836411399918`", 
      RowBox[{"-", "0.039954173453792804`"}], "0.25313295062386404`", 
      RowBox[{"-", "0.026757895126047065`"}], "0.05063814987654759`", 
      RowBox[{"-", "0.055321092296879606`"}], 
      RowBox[{"-", "0.1328838101880483`"}], 
      RowBox[{"-", "0.021749084970500872`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"compute", " ", "the", " ", "time"}], "-", 
    RowBox[{"averaged", " ", "equal", " ", "time", " ", 
     RowBox[{"Green", "'"}], "s", " ", "function", " ", 
     SubscriptBox[
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"G", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Tau]", "\[Prime]",
           MultilineFunction->None], ",", 
          SuperscriptBox["\[Tau]", "\[Prime]",
           MultilineFunction->None]}], ")"}]}], "\[RightAngleBracket]"}], 
      SuperscriptBox["\[Tau]", "\[Prime]",
       MultilineFunction->None]], " ", 
     RowBox[{"(", 
      RowBox[{"average", " ", "over", " ", "diagonal", " ", "blocks"}], 
      ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"n", "=", 
         SubscriptBox["n", "val"]}], ",", 
        RowBox[{"L", "=", 
         SubscriptBox["L", "val"]}]}], "}"}], ",", 
      RowBox[{
       SubscriptBox["G", 
        RowBox[{"\[Tau]", ",", "\[Tau]", ",", "avr"}]], "=", 
       RowBox[{
        FractionBox["1", "L"], 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["invH", "val"], "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"n", 
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}], ";;", 
             RowBox[{"n", " ", "i"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"n", 
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}], ";;", 
             RowBox[{"n", " ", "i"}]}]}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "L"}], "}"}]}], "]"}]}]}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Dimensions", "[", "%", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5", ",", "5"}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"save", " ", "unequal", " ", "time", " ", 
   RowBox[{"Green", "'"}], "s", " ", "functions", " ", "as", " ", "reference",
    " ", "to", " ", "disk"}], " ", "*)"}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     SubscriptBox["fn", "base"], "<>", "\"\<_Gtau0\>\"", "<>", 
     "\"\<.dat\>\""}], ",", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Transpose", "[", 
      SubscriptBox["G", 
       RowBox[{"\[Tau]", ",", "0"}]], "]"}], "]"}], ",", "\"\<Real64\>\""}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     SubscriptBox["fn", "base"], "<>", "\"\<_G0tau\>\"", "<>", 
     "\"\<.dat\>\""}], ",", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Transpose", "[", 
      SubscriptBox["G", 
       RowBox[{"0", ",", "\[Tau]"}]], "]"}], "]"}], ",", "\"\<Real64\>\""}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     SubscriptBox["fn", "base"], "<>", "\"\<_Geqlt\>\"", "<>", 
     "\"\<.dat\>\""}], ",", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Transpose", "[", 
      SubscriptBox["G", 
       RowBox[{"\[Tau]", ",", "\[Tau]"}]], "]"}], "]"}], ",", 
    "\"\<Real64\>\""}], "]"}], ";"}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     SubscriptBox["fn", "base"], "<>", "\"\<_Gtau0_avr\>\"", "<>", 
     "\"\<.dat\>\""}], ",", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Transpose", "[", 
      SubscriptBox["G", 
       RowBox[{"\[Tau]", ",", "0", ",", "avr"}]], "]"}], "]"}], ",", 
    "\"\<Real64\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     SubscriptBox["fn", "base"], "<>", "\"\<_G0tau_avr\>\"", "<>", 
     "\"\<.dat\>\""}], ",", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Transpose", "[", 
      SubscriptBox["G", 
       RowBox[{"0", ",", "\[Tau]", ",", "avr"}]], "]"}], "]"}], ",", 
    "\"\<Real64\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     SubscriptBox["fn", "base"], "<>", "\"\<_Geqlt_avr\>\"", "<>", 
     "\"\<.dat\>\""}], ",", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Transpose", "[", 
      SubscriptBox["G", 
       RowBox[{"\[Tau]", ",", "\[Tau]", ",", "avr"}]], "]"}], "]"}], ",", 
    "\"\<Real64\>\""}], "]"}], ";"}]}], "Input"]
}, Open  ]]
},
WindowSize->{1600, 778},
WindowMargins->{{157, Automatic}, {135, Automatic}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (July 1, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[1464, 33, 435, 12, 87, "Text"],
Cell[CellGroupData[{
Cell[1924, 49, 39, 0, 43, "Subsection"],
Cell[1966, 51, 201, 6, 52, "Input"],
Cell[2170, 59, 230, 7, 52, "Input"],
Cell[2403, 68, 673, 21, 52, "Input"],
Cell[CellGroupData[{
Cell[3101, 93, 164, 4, 52, "Input"],
Cell[3268, 99, 3032, 74, 101, "Output"]
}, Open  ]],
Cell[6315, 176, 242, 7, 31, "Input"],
Cell[6560, 185, 680, 20, 52, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7277, 210, 40, 0, 43, "Subsection"],
Cell[7320, 212, 785, 23, 52, "Input"],
Cell[CellGroupData[{
Cell[8130, 239, 171, 4, 52, "Input"],
Cell[8304, 245, 933, 29, 101, "Output"]
}, Open  ]],
Cell[9252, 277, 725, 22, 31, "Input"],
Cell[CellGroupData[{
Cell[10002, 303, 112, 3, 31, "Input"],
Cell[10117, 308, 6514, 119, 326, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[16680, 433, 46, 0, 43, "Subsection"],
Cell[CellGroupData[{
Cell[16751, 437, 222, 6, 52, "Input"],
Cell[16976, 445, 75, 2, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17088, 452, 260, 7, 52, "Input"],
Cell[17351, 461, 14287, 267, 326, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[31687, 734, 77, 0, 43, "Subsection"],
Cell[CellGroupData[{
Cell[31789, 738, 620, 18, 72, "Input"],
Cell[32412, 758, 74, 2, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32523, 765, 140, 4, 31, "Input"],
Cell[32666, 771, 4107, 91, 326, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36810, 867, 618, 18, 72, "Input"],
Cell[37431, 887, 74, 2, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37542, 894, 140, 4, 31, "Input"],
Cell[37685, 900, 4035, 80, 101, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41757, 985, 1448, 42, 72, "Input"],
Cell[43208, 1029, 74, 2, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43319, 1036, 2043, 58, 88, "Input"],
Cell[45365, 1096, 74, 2, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45476, 1103, 155, 5, 31, "Input"],
Cell[45634, 1110, 4114, 92, 326, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49785, 1207, 2051, 58, 88, "Input"],
Cell[51839, 1267, 74, 2, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51950, 1274, 155, 5, 31, "Input"],
Cell[52108, 1281, 3842, 73, 101, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55987, 1359, 1976, 56, 88, "Input"],
Cell[57966, 1417, 73, 2, 31, "Output"]
}, Open  ]],
Cell[58054, 1422, 219, 4, 31, "Input"],
Cell[58276, 1428, 1084, 33, 72, "Input"],
Cell[59363, 1463, 1134, 33, 72, "Input"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

(* NotebookSignature cxD4T4Zxoiz5EAKoLn9lsmi9 *)
