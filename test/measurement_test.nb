(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     40749,       1023]
NotebookOptionsPosition[     39106,        962]
NotebookOutlinePosition[     39450,        977]
CellTagsIndexPosition[     39407,        974]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "Reference:\n\tR. Blankenbecler, D. J. Scalapino, R. L. Sugar\n\tMonte Carlo \
calculations of coupled boson-fermion systems. I\n\tPhys. Rev. D 24, 2278 \
(1981) ",
 Cell[BoxData[
  FormBox[
   ButtonBox["DOI",
    BaseStyle->"Hyperlink",
    ButtonData->{
      URL["http://dx.doi.org/10.1103/PhysRevD.24.2278"], None},
    ButtonNote->"http://dx.doi.org/10.1103/PhysRevD.24.2278"], 
   TraditionalForm]]]
}], "Text"],

Cell[CellGroupData[{

Cell["Random B matrices", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"block", " ", "size"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    SubscriptBox["n", "val"], "=", "5"}], ";"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"number", " ", "of", " ", "time", " ", "steps"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    SubscriptBox["L", "val"], "=", "4"}], ";"}]}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SeedRandom", "[", "42", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     SubscriptBox["B", 
      RowBox[{"i", ",", "\[Sigma]"}]], "=", 
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
       RowBox[{
        SubscriptBox["n", "val"], 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}]}], ",", 
       RowBox[{"WorkingPrecision", "\[Rule]", 
        RowBox[{"2", "MachinePrecision"}]}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      SubscriptBox["L", "val"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Sigma]", ",", 
      RowBox[{"{", 
       RowBox[{"u", ",", "d"}], "}"}]}], "}"}]}], "]"}], ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "example", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   SubscriptBox["B", 
    RowBox[{"2", ",", "u"}]], "//", "MatrixForm"}]}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
      "-", "0.1699240440775525211731645542040957816955762463018685098881`31.\
909179540382006"}], 
      "0.7951926249697979113718895011313900243089275196658724648808`31.\
909179540382006", 
      RowBox[{
      "-", "0.1513814708210688017835420566673566646427526693125433710035`31.\
909179540382006"}], 
      RowBox[{
      "-", "0.848770628169602040907263112685474388413849696202710374366`31.\
909179540382006"}], 
      RowBox[{
      "-", "0.5957037473734683557873959069457485568261602369131171142017`31.\
909179540382006"}]},
     {
      RowBox[{
      "-", "0.9487599719092318221734450062476211611608536288167103261127`31.\
909179540382006"}], 
      "0.2716997086645923142786585804890408225365982044338496909407`31.\
909179540382006", 
      RowBox[{
      "-", "0.2185123738040529584488151690938889042425458460760964690148`31.\
909179540382006"}], 
      "0.7014806580427521198764794969306389773644824215229806104774`31.\
909179540382006", 
      "0.8465592522642582599242244992325616566956076238649293470314`31.\
909179540382006"},
     {
      RowBox[{
      "-", "0.0058312821377547128729633758215213247007218444076186055682`31.\
909179540382006"}], 
      "0.6713008486973747463396561447771535822476310342188549667198`31.\
909179540382006", 
      "0.4455516523406747424670628431192971607156517838491799995675`31.\
909179540382006", 
      RowBox[{
      "-", "0.4516839236888154889239718504120469305425513012761775324621`31.\
909179540382006"}], 
      "0.6352768473669812621572896259773766305803928670438711773899`31.\
909179540382006"},
     {"0.1998271240307379440933578041680985725042850545467595708009`31.\
909179540382006", 
      RowBox[{
      "-", "0.1300045698003489336244011736655957623150263776552192708732`31.\
909179540382006"}], 
      RowBox[{
      "-", "0.8832421789913679138831722749326076824730991592753762038201`31.\
909179540382006"}], 
      "0.9291069516953158192394451877029448291961148446650936167258`31.\
909179540382006", 
      "0.2802401611709976737750962849319993758222609270054051218849`31.\
909179540382006"},
     {"0.7536464875373469211994753165029302591183615862448564111193`31.\
909179540382006", 
      RowBox[{
      "-", "0.8157398347033144204570840998795225001792094352824935172741`31.\
909179540382006"}], 
      "0.8946309731687639743077342795645029062970367651348924412709`31.\
909179540382006", 
      RowBox[{
      "-", "0.0132627269868978547277709108700541254419170004733523082564`31.\
909179540382006"}], 
      RowBox[{
      "-", "0.7682423165826436602143591529074998382808139001320503410609`31.\
909179540382006"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["fn", "base"], "=", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
    RowBox[{"FileBaseName", "[", 
     RowBox[{"NotebookFileName", "[", "]"}], "]"}]}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"save", " ", "to", " ", "disk"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["fn", "base"], "<>", "\"\<_B\>\"", "<>", 
        RowBox[{"ToString", "[", "\[Sigma]", "]"}], "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"i", "-", "1"}], "]"}], "<>", "\"\<.dat\>\""}], ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Transpose", "[", 
         SubscriptBox["B", 
          RowBox[{"i", ",", "\[Sigma]"}]], "]"}], "]"}], ",", 
       "\"\<Real64\>\""}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       SubscriptBox["L", "val"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Sigma]", ",", 
       RowBox[{"{", 
        RowBox[{"u", ",", "d"}], "}"}]}], "}"}]}], "]"}], ";"}]}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Construct H matrices", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Eq", " ", 
     RowBox[{"(", "45", ")"}]}], ",", " ", 
    RowBox[{"symbolic", " ", "version"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Op", "[", "L_", "]"}], ":=", 
   RowBox[{
    RowBox[{"IdentityMatrix", "[", "L", "]"}], "+", 
    RowBox[{"RotateRight", "[", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"RotateLeft", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"i", "\[Equal]", "1"}], ",", "1", ",", 
            RowBox[{"-", "1"}]}], "]"}], 
          SubscriptBox["b", "i"]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "L"}], "}"}]}], "]"}], "]"}], "]"}], 
     "]"}]}]}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "example", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Op", "[", "5", "]"}], "//", "MatrixForm"}]}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", 
      SubscriptBox["b", "1"]},
     {
      RowBox[{"-", 
       SubscriptBox["b", "2"]}], "1", "0", "0", "0"},
     {"0", 
      RowBox[{"-", 
       SubscriptBox["b", "3"]}], "1", "0", "0"},
     {"0", "0", 
      RowBox[{"-", 
       SubscriptBox["b", "4"]}], "1", "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       SubscriptBox["b", "5"]}], "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     SubscriptBox["H", "\[Sigma]"], "=", 
     RowBox[{"ArrayFlatten", "[", 
      RowBox[{
       RowBox[{"Op", "[", 
        SubscriptBox["L", "val"], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0", "\[Rule]", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{
             SubscriptBox["n", "val"], 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}]}], ",", 
         RowBox[{"1", "\[Rule]", 
          RowBox[{"IdentityMatrix", "[", 
           SubscriptBox["n", "val"], "]"}]}], ",", 
         RowBox[{
          SubscriptBox["b", "i_"], "\[RuleDelayed]", 
          SubscriptBox["B", 
           RowBox[{"i", ",", "\[Sigma]"}]]}]}], "}"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Sigma]", ",", 
      RowBox[{"{", 
       RowBox[{"u", ",", "d"}], "}"}]}], "}"}]}], "]"}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"N", "[", 
   SubscriptBox["H", "u"], "]"}], "//", "MatrixForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.14818943256807487`"}], 
      RowBox[{"-", "0.22344517192272403`"}], "0.7908269452198432`", 
      "0.9965520185656148`", 
      RowBox[{"-", "0.513110639083837`"}]},
     {"0.`", "1.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.9857479592521711`"}], 
      RowBox[{"-", "0.9877734855785923`"}], "0.9094578695948946`", 
      "0.8428757457306598`", 
      RowBox[{"-", "0.044064720359607755`"}]},
     {"0.`", "0.`", "1.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.8606215140816531`", 
      RowBox[{"-", "0.9350647072481315`"}], "0.9950327539971698`", 
      RowBox[{"-", "0.9170822821730071`"}], "0.09146856076958794`"},
     {"0.`", "0.`", "0.`", "1.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.44125448507560616`"}], "0.3023452009777999`", 
      "0.46159247475054227`", 
      RowBox[{"-", "0.8649963526990475`"}], 
      RowBox[{"-", "0.8370678837961374`"}]},
     {"0.`", "0.`", "0.`", "0.`", "1.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.5225551652464618`"}], 
      RowBox[{"-", "0.7223353953785538`"}], 
      RowBox[{"-", "0.2699662724355662`"}], "0.5570803964160375`", 
      "0.23494615192458695`"},
     {"0.16992404407755252`", 
      RowBox[{"-", "0.7951926249697979`"}], "0.15138147082106881`", 
      "0.848770628169602`", "0.5957037473734683`", "1.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`"},
     {"0.9487599719092318`", 
      RowBox[{"-", "0.2716997086645923`"}], "0.21851237380405295`", 
      RowBox[{"-", "0.7014806580427522`"}], 
      RowBox[{"-", "0.8465592522642582`"}], "0.`", "1.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.005831282137754713`", 
      RowBox[{"-", "0.6713008486973747`"}], 
      RowBox[{"-", "0.44555165234067473`"}], "0.4516839236888155`", 
      RowBox[{"-", "0.6352768473669813`"}], "0.`", "0.`", "1.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {
      RowBox[{"-", "0.19982712403073793`"}], "0.13000456980034894`", 
      "0.8832421789913679`", 
      RowBox[{"-", "0.9291069516953159`"}], 
      RowBox[{"-", "0.28024016117099765`"}], "0.`", "0.`", "0.`", "1.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`"},
     {
      RowBox[{"-", "0.753646487537347`"}], "0.8157398347033145`", 
      RowBox[{"-", "0.8946309731687639`"}], "0.013262726986897854`", 
      "0.7682423165826436`", "0.`", "0.`", "0.`", "0.`", "1.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.23622627398352114`", 
      RowBox[{"-", "0.12176156328413652`"}], 
      RowBox[{"-", "0.34348208582619`"}], 
      RowBox[{"-", "0.7103203721018805`"}], 
      RowBox[{"-", "0.1772633949337909`"}], "1.`", "0.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.6493580925464275`", 
      RowBox[{"-", "0.3879030771478586`"}], 
      RowBox[{"-", "0.38373064951666586`"}], "0.03534781802952623`", 
      RowBox[{"-", "0.8009481206343173`"}], "0.`", "1.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.3679939207685129`"}], 
      RowBox[{"-", "0.14555034380863605`"}], 
      RowBox[{"-", "0.5719263300489104`"}], "0.7695583198760179`", 
      RowBox[{"-", "0.38874319762565335`"}], "0.`", "0.`", "1.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.3706461314356914`"}], 
      RowBox[{"-", "0.6306237257121398`"}], "0.6510362477771195`", 
      RowBox[{"-", "0.8860495846306607`"}], 
      RowBox[{"-", "0.9655460885435924`"}], "0.`", "0.`", "0.`", "1.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.15165623153350302`", 
      RowBox[{"-", "0.6110106334654467`"}], 
      RowBox[{"-", "0.6966604195279351`"}], 
      RowBox[{"-", "0.32042460330903366`"}], 
      RowBox[{"-", "0.2577028010043679`"}], "0.`", "0.`", "0.`", "0.`", "1.`",
       "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.31042411380667057`", 
      RowBox[{"-", "0.7935260502222217`"}], "0.40516206382466324`", 
      "0.11710003663946231`", 
      RowBox[{"-", "0.6070378904196219`"}], "1.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.31735267686677665`"}], "0.5047697288617823`", 
      RowBox[{"-", "0.48116741487643894`"}], 
      RowBox[{"-", "0.008413863168452896`"}], 
      RowBox[{"-", "0.2536305386709227`"}], "0.`", "1.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.6487436056695856`", "0.6102422217831371`", "0.3936456635867907`", 
      "0.4814077306400182`", 
      RowBox[{"-", "0.6448305048982449`"}], "0.`", "0.`", "1.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.5270173739725478`", "0.9223105357660655`", 
      RowBox[{"-", "0.7879156013886853`"}], 
      RowBox[{"-", "0.3858077702664369`"}], 
      RowBox[{"-", "0.5473056606777297`"}], "0.`", "0.`", "0.`", "1.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.8878166471476883`", 
      RowBox[{"-", "0.30918810528812923`"}], "0.720013737190996`", 
      RowBox[{"-", "0.5213140531995892`"}], "0.828696990558102`", "0.`", 
      "0.`", "0.`", "0.`", "1.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Compute inverse H matrices and accumulate circularly  shifted columns\
\>", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     SubscriptBox["invH", "\[Sigma]"], "=", 
     RowBox[{"Inverse", "[", 
      SubscriptBox["H", "\[Sigma]"], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Sigma]", ",", 
      RowBox[{"{", 
       RowBox[{"u", ",", "d"}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "%", "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "20", ",", "20"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"no", " ", "obvious", " ", "block", " ", "structure"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"N", "[", 
    SubscriptBox["invH", "u"], "]"}], "//", "MatrixForm"}]}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.3327860938457681`", 
      RowBox[{"-", "2.1235557359674524`"}], 
      RowBox[{"-", "3.014829182277032`"}], "1.4634427323159784`", 
      RowBox[{"-", "0.9254623514567836`"}], 
      RowBox[{"-", "1.7633401242634283`"}], 
      RowBox[{"-", "1.4882635551479408`"}], 
      RowBox[{"-", "4.218362504820612`"}], 
      RowBox[{"-", "1.0045887649568954`"}], 
      RowBox[{"-", "2.922732467468488`"}], 
      RowBox[{"-", "6.382755768361774`"}], "1.4039109563670933`", 
      RowBox[{"-", "5.545134375752634`"}], 
      RowBox[{"-", "0.8161244999464611`"}], "0.10817008622985669`", 
      "0.7127970421650502`", 
      RowBox[{"-", "5.953252072482198`"}], "3.742604275895766`", 
      "0.47483810359213174`", "1.7953790111094272`"},
     {"0.12358586467603137`", 
      RowBox[{"-", "0.4991035903644804`"}], 
      RowBox[{"-", "1.1346430182255804`"}], "0.5352245159494178`", 
      RowBox[{"-", "1.687856485863085`"}], 
      RowBox[{"-", "0.1717814563921664`"}], 
      RowBox[{"-", "0.5956919404707487`"}], 
      RowBox[{"-", "2.524289352356024`"}], 
      RowBox[{"-", "0.3661035850320884`"}], 
      RowBox[{"-", "0.5471199395663878`"}], 
      RowBox[{"-", "2.612569100484499`"}], "0.5736989943616818`", 
      RowBox[{"-", "1.8414787286277747`"}], "0.3862950352373469`", 
      RowBox[{"-", "0.7785461890521596`"}], 
      RowBox[{"-", "0.14300594090736213`"}], 
      RowBox[{"-", "2.9073723159087375`"}], "0.7824656906357009`", 
      "0.6602005738195978`", "0.9897791650061942`"},
     {"0.7235593253754629`", 
      RowBox[{"-", "0.024976270115706`"}], "0.6779445557143321`", 
      RowBox[{"-", "1.3096702411123329`"}], 
      RowBox[{"-", "2.5225576630725293`"}], "1.511927374280179`", 
      RowBox[{"-", "0.7929063727266641`"}], 
      RowBox[{"-", "1.1519886822643868`"}], "0.014347253710095778`", 
      "0.290069380528574`", "1.4510699661332946`", 
      RowBox[{"-", "1.0171115888407682`"}], "1.461509781352966`", 
      "0.8742563847651231`", 
      RowBox[{"-", "2.1916153361726654`"}], 
      RowBox[{"-", "2.396923535773303`"}], 
      RowBox[{"-", "0.6552332066715908`"}], 
      RowBox[{"-", "1.3005439454932535`"}], "0.1941257675118269`", 
      RowBox[{"-", "0.19546287854447653`"}]},
     {
      RowBox[{"-", "0.36552081932710795`"}], 
      RowBox[{"-", "0.37131730294390725`"}], 
      RowBox[{"-", "0.9374643931036594`"}], "0.5678005809407098`", 
      RowBox[{"-", "1.5649949008009456`"}], "0.5197667812718773`", 
      RowBox[{"-", "0.40806247759818803`"}], 
      RowBox[{"-", "2.007789679117368`"}], 
      RowBox[{"-", "0.6686217825048477`"}], 
      RowBox[{"-", "0.7197705022974199`"}], 
      RowBox[{"-", "2.610931104295394`"}], 
      RowBox[{"-", "0.2158434445399637`"}], 
      RowBox[{"-", "1.1271073737897275`"}], "0.4111171741111721`", 
      RowBox[{"-", "0.16633829446504478`"}], 
      RowBox[{"-", "0.1806411870586546`"}], 
      RowBox[{"-", "2.6271641083887487`"}], "0.8749806180149007`", 
      "1.1804762851676753`", "0.7248110649186801`"},
     {"0.1845337610586981`", "0.23504359201313413`", "0.877266358194798`", 
      "0.2091662265239379`", "1.701718517641667`", "0.0446265983722324`", 
      "0.6187113995016649`", "1.2603504642256982`", "0.424769877993463`", 
      "0.9309330445979358`", "1.48970163064846`", "0.03143241297786922`", 
      "1.1053866754860584`", "0.1437004457917174`", "0.28415209119327456`", 
      "0.48558272982991624`", "2.259674929982639`", 
      RowBox[{"-", "0.8697482265789317`"}], 
      RowBox[{"-", "0.3445506044722481`"}], 
      RowBox[{"-", "0.19992481175261256`"}]},
     {"0.13250861680996331`", "0.14288750074322878`", 
      RowBox[{"-", "0.21949465239018`"}], 
      RowBox[{"-", "0.2313412728992473`"}], 
      RowBox[{"-", "0.4884426277967515`"}], "0.466409738751571`", 
      RowBox[{"-", "0.1229839967279191`"}], 
      RowBox[{"-", "0.16274790635490427`"}], "0.191878528667394`", 
      "0.07402540839947275`", "0.1160836755072695`", "0.5360920001547563`", 
      RowBox[{"-", "0.4451514975004622`"}], 
      RowBox[{"-", "0.12103515499461037`"}], 
      RowBox[{"-", "0.33379234003526975`"}], 
      RowBox[{"-", "0.00792933326304755`"}], 
      RowBox[{"-", "0.31736728258078`"}], 
      RowBox[{"-", "0.04141482306477109`"}], 
      RowBox[{"-", "0.3817903396097014`"}], "0.015474104865662332`"},
     {
      RowBox[{"-", "0.5404495694877488`"}], "1.8231024258728332`", 
      "2.4889726114853854`", 
      RowBox[{"-", "0.3814836577829033`"}], "1.3134534851217021`", 
      "1.6983241190380238`", "2.6609433402261797`", "3.2266243127804115`", 
      "0.7410759408860985`", "2.844120393193217`", "4.458395206564282`", 
      RowBox[{"-", "1.0786498036781613`"}], "4.586445624041991`", 
      "1.098268355995488`", "0.28860533444305336`", "0.09298773135501777`", 
      "5.071495532777486`", 
      RowBox[{"-", "3.1765639113653377`"}], "0.2228488146999944`", 
      RowBox[{"-", "1.0525572281613518`"}]},
     {"0.6857356830485845`", 
      RowBox[{"-", "0.016758021132101387`"}], "0.5386974171802152`", 
      RowBox[{"-", "0.3563507489234187`"}], 
      RowBox[{"-", "0.46364718192646903`"}], "0.36218718168713904`", 
      RowBox[{"-", "0.1671224767374507`"}], "0.5243282061663888`", 
      "0.3383370149085177`", "0.6955110639638445`", "1.0556149774436543`", 
      "0.04122357006015037`", "0.6586499509808524`", "0.5592001618920203`", 
      RowBox[{"-", "1.244099743909712`"}], 
      RowBox[{"-", "0.7780375861650877`"}], "0.4132203096670568`", 
      RowBox[{"-", "1.023759393199293`"}], 
      RowBox[{"-", "0.22516983503306628`"}], "0.11248831357072368`"},
     {
      RowBox[{"-", "0.8765393175797401`"}], 
      RowBox[{"-", "0.6165230259881049`"}], 
      RowBox[{"-", "1.6788845130904722`"}], "1.9657741609212402`", 
      "1.285368133152272`", 
      RowBox[{"-", "1.170003745057199`"}], "0.2746296984648902`", 
      RowBox[{"-", "1.0095396334396676`"}], "0.3319953885993933`", 
      RowBox[{"-", "1.176973593481932`"}], 
      RowBox[{"-", "4.225808019685421`"}], "0.912578833533257`", 
      RowBox[{"-", "2.8969642448588746`"}], 
      RowBox[{"-", "0.5632415853073918`"}], "1.983641746759404`", 
      "2.2463363752028194`", 
      RowBox[{"-", "2.040584717662886`"}], "2.364057193235897`", 
      "0.837828181076029`", "1.0201307061627138`"},
     {"0.6603889000629501`", 
      RowBox[{"-", "1.3912619396492638`"}], 
      RowBox[{"-", "1.4015515229543132`"}], 
      RowBox[{"-", "0.6735779760878593`"}], 
      RowBox[{"-", "2.863953972790895`"}], "0.12263337783885483`", 
      RowBox[{"-", "1.814961813292822`"}], 
      RowBox[{"-", "3.0922212557581656`"}], 
      RowBox[{"-", "0.763082465567287`"}], 
      RowBox[{"-", "1.2025305159655362`"}], 
      RowBox[{"-", "2.4908164088450295`"}], 
      RowBox[{"-", "0.34116112937969817`"}], 
      RowBox[{"-", "2.2036478764321137`"}], 
      RowBox[{"-", "0.26389806887647`"}], 
      RowBox[{"-", "1.4601653773148595`"}], 
      RowBox[{"-", "1.8611588121784317`"}], 
      RowBox[{"-", "4.402314565401597`"}], "1.6753780014006308`", 
      "0.24202110614373562`", "0.5147893770674217`"},
     {
      RowBox[{"-", "0.3671310343612387`"}], 
      RowBox[{"-", "0.5020747404444337`"}], 
      RowBox[{"-", "0.9010451406664728`"}], "1.162727456510528`", 
      "0.5214055970106132`", 
      RowBox[{"-", "0.5883219130739892`"}], "0.1689978722292043`", 
      RowBox[{"-", "0.653812707875464`"}], "0.26167701828812395`", 
      RowBox[{"-", "0.4814795728450304`"}], 
      RowBox[{"-", "1.5651841075266364`"}], "0.3439304123829029`", 
      RowBox[{"-", "1.5585550964830144`"}], 
      RowBox[{"-", "0.09246764644639589`"}], "0.8368528541781153`", 
      "1.011656635783143`", 
      RowBox[{"-", "1.3954206326072562`"}], "1.2475780473553297`", 
      "0.678009433080531`", "0.7226942523426287`"},
     {"0.5273712060344891`", 
      RowBox[{"-", "0.48456457245167917`"}], "0.2515003194985547`", 
      RowBox[{"-", "0.7434849027542515`"}], 
      RowBox[{"-", "1.6905623235551375`"}], "0.6344805889251094`", 
      RowBox[{"-", "0.4154790672152609`"}], 
      RowBox[{"-", "0.8825238072522734`"}], 
      RowBox[{"-", "0.3302267342877093`"}], "0.40050185826119267`", 
      "0.21347553799634975`", 
      RowBox[{"-", "0.05621854530248801`"}], "0.6582970113395173`", 
      "0.5277397722942538`", 
      RowBox[{"-", "1.3883316705261914`"}], 
      RowBox[{"-", "1.8274324066751286`"}], 
      RowBox[{"-", "1.12199632634439`"}], 
      RowBox[{"-", "0.33982712427209816`"}], "0.41218877262866943`", 
      "0.0010869802489797895`"},
     {"1.2935598546037947`", "0.24195737187665992`", "1.3367492829153056`", 
      RowBox[{"-", "2.1190903524482505`"}], 
      RowBox[{"-", "2.3562507087402738`"}], "1.5740310012169532`", 
      RowBox[{"-", "0.6704355181182066`"}], "0.2844427900325949`", 
      RowBox[{"-", "0.18015509385760958`"}], "1.2772589547766182`", 
      "3.57909082630621`", 
      RowBox[{"-", "0.7710491098377877`"}], "3.2531747568784213`", 
      "0.7659931008568444`", 
      RowBox[{"-", "2.8865177147396968`"}], 
      RowBox[{"-", "2.8865634061762244`"}], "0.7166793687698524`", 
      RowBox[{"-", "2.2310934053737146`"}], 
      RowBox[{"-", "0.7875149484542004`"}], 
      RowBox[{"-", "0.6680998653069625`"}]},
     {
      RowBox[{"-", "0.8771666798067941`"}], 
      RowBox[{"-", "0.6760350723221452`"}], 
      RowBox[{"-", "1.703298723844601`"}], "0.9970816596820136`", 
      RowBox[{"-", "0.677272974190335`"}], "0.08980631096112868`", 
      "0.2321795012521948`", 
      RowBox[{"-", "2.247077015523081`"}], 
      RowBox[{"-", "0.12443746913369702`"}], 
      RowBox[{"-", "0.8357514830606529`"}], 
      RowBox[{"-", "3.981921334313626`"}], 
      RowBox[{"-", "0.02917646799595192`"}], 
      RowBox[{"-", "2.396054799390511`"}], "0.5298075744823985`", 
      "1.2159845379444578`", "0.7555627645521729`", 
      RowBox[{"-", "3.2471437982820244`"}], "2.360264231468213`", 
      "1.1216582061296656`", "0.6696731446873702`"},
     {"0.01672802353610503`", "0.5245092933651374`", "1.0302259751705087`", 
      "0.010037786578975846`", "0.2274193873853372`", "0.8759866055009466`", 
      "1.14836571983945`", "1.2411067920491532`", "0.5691427141833041`", 
      "1.5240696391745605`", "1.445984015963191`", 
      RowBox[{"-", "0.5071548306308051`"}], "1.8325875467022716`", 
      "0.8304982657168157`", "0.619566479246301`", 
      RowBox[{"-", "0.24385336283460862`"}], "1.6464003153959743`", 
      RowBox[{"-", "1.4585944680485439`"}], "0.3680272473566312`", 
      RowBox[{"-", "0.10756660620049245`"}]},
     {"0.12121853020852472`", "0.07087029365318218`", "0.7625206417635632`", 
      RowBox[{"-", "0.2030032400314482`"}], 
      RowBox[{"-", "0.33133783835800884`"}], "0.5696092739295247`", 
      "0.5593938362008135`", "0.4039398212725838`", "0.08978046175351173`", 
      "0.9728092011582771`", "0.5492076849807751`", 
      RowBox[{"-", "0.14342095805710875`"}], "1.0811540966049973`", 
      "0.5792315274732692`", "0.04175931660456564`", "0.16886349429116107`", 
      "0.6321356399019945`", 
      RowBox[{"-", "0.9147947135757974`"}], "0.527743499899436`", 
      RowBox[{"-", "0.0965062109111441`"}]},
     {"0.23657019123324396`", "0.32902427613992724`", "0.47726680798589144`", 
      RowBox[{"-", "0.2644186853414919`"}], 
      RowBox[{"-", "0.06295489510159956`"}], "0.4733328716115379`", 
      "0.2339756008165948`", "0.67072267752521`", "0.30635257390990617`", 
      "0.6391340486300018`", "1.4509128883796114`", 
      RowBox[{"-", "0.3623544897203868`"}], "1.1830617414764013`", 
      "0.28793645419491937`", 
      RowBox[{"-", "0.2551608650866825`"}], 
      RowBox[{"-", "0.2009272082166228`"}], "1.8586084427408205`", 
      RowBox[{"-", "0.8561579282530077`"}], 
      RowBox[{"-", "0.26903841073408524`"}], 
      RowBox[{"-", "0.11431524232408366`"}]},
     {
      RowBox[{"-", "0.15979293226340344`"}], "1.1898421709738758`", 
      "1.3891679101312515`", "0.06003445629864655`", "2.093613239107214`", 
      RowBox[{"-", "0.1034978103097857`"}], "1.0365488546561181`", 
      "2.732804197585013`", "0.529580018497155`", "0.9502700212732151`", 
      "2.3255801277189483`", 
      RowBox[{"-", "0.19827871558902904`"}], "1.663971542672842`", 
      RowBox[{"-", "0.28311400540262593`"}], "1.2547118551583656`", 
      "1.0741759630030685`", "3.932691291580087`", 
      RowBox[{"-", "0.800516832030538`"}], 
      RowBox[{"-", "0.684047168066216`"}], 
      RowBox[{"-", "0.598260039323575`"}]},
     {"0.3970380259050166`", "0.9284104313130603`", "1.2028532898407283`", 
      RowBox[{"-", "1.2065423719181034`"}], 
      RowBox[{"-", "0.7089223182969023`"}], "1.4791517211586678`", 
      "0.4839730164793368`", "1.1949735736549274`", "0.28820233879988766`", 
      "1.402425798726733`", "2.703149026961951`", 
      RowBox[{"-", "1.0257531869095207`"}], "2.85602746831523`", 
      "0.8244702997902051`", 
      RowBox[{"-", "0.626666883354109`"}], 
      RowBox[{"-", "0.9640291439659008`"}], "1.9832337099173403`", 
      RowBox[{"-", "1.9896712001509382`"}], "0.27618373438537175`", 
      RowBox[{"-", "0.7087879772657791`"}]},
     {
      RowBox[{"-", "0.9135206971698042`"}], 
      RowBox[{"-", "0.6653697775217706`"}], 
      RowBox[{"-", "1.8264527906545942`"}], "0.7750830815829394`", 
      "0.16938486670700562`", 
      RowBox[{"-", "1.0939382759777831`"}], 
      RowBox[{"-", "0.6263863061543196`"}], 
      RowBox[{"-", "2.097137064282181`"}], 
      RowBox[{"-", "0.7412271047454182`"}], 
      RowBox[{"-", "2.0670289191226967`"}], 
      RowBox[{"-", "4.395508110699912`"}], "0.6375042791557889`", 
      RowBox[{"-", "3.522838572673071`"}], 
      RowBox[{"-", "0.7182956584859156`"}], "1.0265818246856253`", 
      "1.2111453750658987`", 
      RowBox[{"-", "2.6811979229831144`"}], "2.8328985963332736`", 
      "0.3722704985625333`", "1.2780073183911813`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Accumulate circularly  shifted columns (unequal time Green\[CloseCurlyQuote]s \
functions)\
\>", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"compute", " ", "unequal", " ", "time", " ", 
    RowBox[{"Green", "'"}], "s", " ", "functions"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"n", "=", 
         SubscriptBox["n", "val"]}], ",", 
        RowBox[{"L", "=", 
         SubscriptBox["L", "val"]}]}], "}"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         SubscriptBox["G", "\[Sigma]"], "=", 
         RowBox[{
          FractionBox["1", "L"], 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"RotateLeft", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["invH", "\[Sigma]"], "\[LeftDoubleBracket]", 
               RowBox[{";;", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"n", 
                   RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}], ";;", 
                 RowBox[{"n", " ", "i"}]}]}], "\[RightDoubleBracket]"}], ",", 
              RowBox[{"n", 
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "L"}], "}"}]}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Sigma]", ",", 
          RowBox[{"{", 
           RowBox[{"u", ",", "d"}], "}"}]}], "}"}]}], "]"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Dimensions", "[", "%", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "20", ",", "5"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "example", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"N", "[", 
    SubscriptBox["G", "u"], "]"}], "//", "MatrixForm"}]}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "0.14928119515953406`"}], 
      RowBox[{"-", "0.3176184201026185`"}], 
      RowBox[{"-", "1.4127317246726872`"}], "0.5226492786091032`", 
      RowBox[{"-", "0.027772574947584925`"}]},
     {"0.45861457837344555`", "0.991057411825008`", "0.4735300944103351`", 
      "0.38375045459892126`", 
      RowBox[{"-", "0.08659575138003578`"}]},
     {"1.4347533240929702`", "0.7423858587222856`", "0.9137326716821511`", 
      RowBox[{"-", "0.2223468233532967`"}], 
      RowBox[{"-", "1.3279560882929893`"}]},
     {
      RowBox[{"-", "1.6203687606659585`"}], "0.46434240936059284`", 
      RowBox[{"-", "1.5831825065211942`"}], "0.42644681960196834`", 
      RowBox[{"-", "0.5586929834010498`"}]},
     {"0.7410741324816607`", 
      RowBox[{"-", "1.1920677437234017`"}], "0.6126328113680444`", 
      "0.16221313130899997`", "0.5991904498284033`"},
     {"0.2015478577204499`", 
      RowBox[{"-", "1.4461969143917184`"}], "0.9876127530587798`", 
      "0.2711013441135694`", "0.2168040317680527`"},
     {"0.3504844917274025`", 
      RowBox[{"-", "0.46552586174288796`"}], "0.8929940590863036`", 
      "0.05910665898597616`", "0.6121434108256016`"},
     {"0.5471058190527958`", 
      RowBox[{"-", "0.385176365377732`"}], "0.2966419510980997`", 
      RowBox[{"-", "0.15637352016795683`"}], "0.46821518736600953`"},
     {"0.4339437083211713`", 
      RowBox[{"-", "1.0093152050085448`"}], 
      RowBox[{"-", "0.04873836057085562`"}], "0.9615708191863559`", 
      "0.1369402079140475`"},
     {
      RowBox[{"-", "0.5933874688265247`"}], "0.6635707473321536`", 
      RowBox[{"-", "1.1382578825392906`"}], 
      RowBox[{"-", "0.2918203812156797`"}], 
      RowBox[{"-", "0.12830683017083042`"}]},
     {
      RowBox[{"-", "1.547051715514134`"}], "0.28596569238567326`", 
      RowBox[{"-", "1.5209136295528236`"}], "0.01364826967696931`", 
      "0.4044647473161023`"},
     {
      RowBox[{"-", "0.3797193228708636`"}], "1.3486513888760208`", 
      RowBox[{"-", "1.023954910742337`"}], "0.043002880273248986`", 
      RowBox[{"-", "0.7206329230346618`"}]},
     {"0.465773606065554`", "0.16865373683976667`", "1.126825967163498`", 
      RowBox[{"-", "0.23510594605475965`"}], 
      RowBox[{"-", "0.87127692751725`"}]},
     {"0.059347578064824824`", 
      RowBox[{"-", "0.6121225545114145`"}], "0.18215616731412396`", 
      "0.6335573384172756`", "0.3947363090585167`"},
     {
      RowBox[{"-", "0.36216685849291236`"}], 
      RowBox[{"-", "1.1181897913032275`"}], "0.42846339694375424`", 
      RowBox[{"-", "0.08636694155774734`"}], 
      RowBox[{"-", "0.26016701586916585`"}]},
     {
      RowBox[{"-", "0.1285953206911228`"}], 
      RowBox[{"-", "0.5691804734868147`"}], 
      RowBox[{"-", "0.6633538283005453`"}], 
      RowBox[{"-", "0.16265443172560579`"}], 
      RowBox[{"-", "0.7162920983797844`"}]},
     {"0.6739378836825575`", 
      RowBox[{"-", "0.6168284485883432`"}], "0.5498989888499402`", 
      "0.21998371456264426`", 
      RowBox[{"-", "0.08009562999398856`"}]},
     {
      RowBox[{"-", "0.11970349667894867`"}], "0.2887096842693036`", 
      RowBox[{"-", "0.3338160566314993`"}], 
      RowBox[{"-", "0.038483269138359484`"}], "0.11787075260477844`"},
     {
      RowBox[{"-", "0.6383601119890887`"}], 
      RowBox[{"-", "0.4535542527584738`"}], 
      RowBox[{"-", "0.3354091006668252`"}], 
      RowBox[{"-", "0.3291868834001694`"}], "0.30615551771311306`"},
     {
      RowBox[{"-", "0.9008909676193024`"}], "0.3146452019990426`", 
      RowBox[{"-", "1.0570861677273884`"}], "0.32599553451414087`", 
      RowBox[{"-", "0.11685351805260266`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"save", " ", "unequal", " ", "time", " ", 
    RowBox[{"Green", "'"}], "s", " ", "functions", " ", "as", " ", 
    "reference", " ", "to", " ", "disk"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["fn", "base"], "<>", "\"\<_G\>\"", "<>", 
        RowBox[{"ToString", "[", "\[Sigma]", "]"}], "<>", "\"\<.dat\>\""}], 
       ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Transpose", "[", 
         SubscriptBox["G", "\[Sigma]"], "]"}], "]"}], ",", "\"\<Real64\>\""}],
       "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Sigma]", ",", 
       RowBox[{"{", 
        RowBox[{"u", ",", "d"}], "}"}]}], "}"}]}], "]"}], ";"}]}]], "Input"]
}, Open  ]]
},
WindowSize->{1600, 778},
WindowMargins->{{157, Automatic}, {135, Automatic}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (July 1, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 435, 12, 87, "Text"],
Cell[CellGroupData[{
Cell[1018, 36, 39, 0, 43, "Subsection"],
Cell[1060, 38, 201, 6, 52, "Input"],
Cell[1264, 46, 230, 7, 52, "Input"],
Cell[1497, 55, 830, 26, 52, "Input"],
Cell[CellGroupData[{
Cell[2352, 85, 189, 5, 52, "Input"],
Cell[2544, 92, 3157, 81, 101, "Output"]
}, Open  ]],
Cell[5716, 176, 242, 7, 31, "Input"],
Cell[5961, 185, 906, 26, 52, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6904, 216, 42, 0, 43, "Subsection"],
Cell[6949, 218, 807, 25, 52, "Input"],
Cell[CellGroupData[{
Cell[7781, 247, 171, 4, 52, "Input"],
Cell[7955, 253, 933, 29, 101, "Output"]
}, Open  ]],
Cell[8903, 285, 980, 29, 31, "Input"],
Cell[CellGroupData[{
Cell[9908, 318, 110, 3, 31, "Input"],
Cell[10021, 323, 6590, 123, 326, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[16660, 452, 99, 2, 43, "Subsection"],
Cell[CellGroupData[{
Cell[16784, 458, 412, 13, 52, "Input"],
Cell[17199, 473, 85, 2, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17321, 480, 258, 7, 52, "Input"],
Cell[17582, 489, 14405, 278, 326, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[32036, 773, 120, 3, 43, "Subsection"],
Cell[CellGroupData[{
Cell[32181, 780, 1571, 45, 88, "Input"],
Cell[33755, 827, 84, 2, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33876, 834, 194, 5, 52, "Input"],
Cell[34073, 841, 4177, 93, 326, "Output"]
}, Open  ]],
Cell[38265, 937, 825, 22, 52, "Input"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
